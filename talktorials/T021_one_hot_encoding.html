<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="T021 · One-Hot Encoding" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://projects.volkamerlab.org/teachopencadd/talktorials/T021_one_hot_encoding.html" />
<meta property="og:site_name" content="TeachOpenCADD" />
<meta property="og:description" content="Developed in the CADD seminar 2020, Volkamer Lab, Charité/FU Berlin Note: This talktorial is a part of TeachOpenCADD, a platform that aims to teach domain-specific skills and to provide pipeline templates as starting points for research projects. Authors: Sakshi Misra, CADD seminar 2020, Charité/..." />
<meta property="og:image" content="https://raw.githubusercontent.com/volkamerlab/teachopencadd/master/docs/_static/images/TeachOpenCADD_topics.png" />
<meta property="og:image:alt" content="TeachOpenCADD" />
<meta name="description" content="Developed in the CADD seminar 2020, Volkamer Lab, Charité/FU Berlin Note: This talktorial is a part of TeachOpenCADD, a platform that aims to teach domain-specific skills and to provide pipeline templates as starting points for research projects. Authors: Sakshi Misra, CADD seminar 2020, Charité/..." />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#2196f3">
  <script src="../_static/javascripts/modernizr.js"></script>
  
    <script async src="../_static/cookieconsent.min.js"></script>
    <script>
        window.addEventListener("load", function(){
        window.cookieconsent.initialise({
            "palette": {
            "popup": {
                "background": "#f0f0f0",
                "text": "#999"
            },
            "button": {
                "text": "#fff",
                "background": "#009688"
            }
            },
            "theme": "classic"
        })});
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q6ZE82CNZB"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-Q6ZE82CNZB');
    </script>
  
    <link rel="apple-touch-icon" href="../_static/images/apple-icon-152x152.png"/>
  
  
    <title>T021 · One-Hot Encoding &#8212; TeachOpenCADD 0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=92fd9be5" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=897d968c" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=e43216b9"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="T022 · Ligand-based screening: neural networks" href="T022_ligand_based_screening_neural_network.html" />
    <link rel="prev" title="T020 · Analyzing molecular dynamics simulations" href="T020_md_analysis.html" />
  
    <link rel="apple-touch-icon" href="../_static/images/apple-icon-152x152.png"/>
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=teal data-md-color-accent=cyan>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#talktorials/T021_one_hot_encoding" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="TeachOpenCADD 0 documentation"
           class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">TeachOpenCADD</span>
          <span class="md-header-nav__topic"> T021 · One-Hot Encoding </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/volkamerlab/teachopencadd/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    TeachOpenCADD
  </div>
</a>
          </div>
        </div>
      
      
    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../talktorials.html" class="md-tabs__link">Our talktorials</a></li>
            
            <li class="md-tabs__item"><a href="../installing.html" class="md-tabs__link">Run locally</a></li>
            
            <li class="md-tabs__item"><a href="../contribute.html" class="md-tabs__link">Development</a></li>
            
            <li class="md-tabs__item"><a href="../contact.html" class="md-tabs__link">Contact</a></li>
            
            <li class="md-tabs__item"><a href="../citation.html" class="md-tabs__link">Citation</a></li>
          <li class="md-tabs__item"><a href="../all_talktorials.html" class="md-tabs__link">Complete list of talktorials</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="TeachOpenCADD 0 documentation" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    <a href="../index.html"
       title="TeachOpenCADD 0 documentation">TeachOpenCADD</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/volkamerlab/teachopencadd/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    TeachOpenCADD
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Our talktorials</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../all_talktorials.html" class="md-nav__link">Complete list of talktorials</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="T001_query_chembl.html" class="md-nav__link">T001 · Compound data acquisition (ChEMBL)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T002_compound_adme.html" class="md-nav__link">T002 · Molecular filtering: ADME and lead-likeness criteria</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T003_compound_unwanted_substructures.html" class="md-nav__link">T003 · Molecular filtering: unwanted substructures</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T004_compound_similarity.html" class="md-nav__link">T004 · Ligand-based screening: compound similarity</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T005_compound_clustering.html" class="md-nav__link">T005 · Compound clustering</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T006_compound_maximum_common_substructures.html" class="md-nav__link">T006 · Maximum common substructure</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T007_compound_activity_machine_learning.html" class="md-nav__link">T007 · Ligand-based screening: machine learning</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T008_query_pdb.html" class="md-nav__link">T008 · Protein data acquisition: Protein Data Bank (PDB)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T009_compound_ensemble_pharmacophores.html" class="md-nav__link">T009 · Ligand-based pharmacophores</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T010_binding_site_comparison.html" class="md-nav__link">T010 · Binding site similarity and off-target prediction</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T011_query_online_api_webservices.html" class="md-nav__link">T011 · Querying online API webservices</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T012_query_klifs.html" class="md-nav__link">T012 · Data acquisition from KLIFS</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T013_query_pubchem.html" class="md-nav__link">T013 · Data acquisition from PubChem</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T014_binding_site_detection.html" class="md-nav__link">T014 · Binding site detection</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T015_protein_ligand_docking.html" class="md-nav__link">T015 · Protein ligand docking</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T016_protein_ligand_interactions.html" class="md-nav__link">T016 · Protein-ligand interactions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T017_advanced_nglview_usage.html" class="md-nav__link">T017 · Advanced NGLview usage</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T018_automated_cadd_pipeline.html" class="md-nav__link">T018 · Automated pipeline for lead optimization</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T019_md_simulation.html" class="md-nav__link">T019 · Molecular dynamics simulation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T020_md_analysis.html" class="md-nav__link">T020 · Analyzing molecular dynamics simulations</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> T021 · One-Hot Encoding </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">T021 · One-Hot Encoding</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#talktorials-t021-one-hot-encoding--page-root" class="md-nav__link">T021 · One-Hot Encoding</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Aim-of-this-talktorial" class="md-nav__link">Aim of this talktorial</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Contents-in-Theory" class="md-nav__link">Contents in <em>Theory</em></a>
        </li>
        <li class="md-nav__item"><a href="#Contents-in-Practical" class="md-nav__link">Contents in <em>Practical</em></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#References" class="md-nav__link">References</a>
        </li>
        <li class="md-nav__item"><a href="#Theory" class="md-nav__link">Theory</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Molecular-data-and-representation" class="md-nav__link">Molecular data and representation</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#ChEMBL-database" class="md-nav__link">ChEMBL database</a>
        </li>
        <li class="md-nav__item"><a href="#SMILES-structures-and-rules" class="md-nav__link">SMILES structures and rules</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#What-is-categorical-data?" class="md-nav__link">What is categorical data?</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#What-is-the-problem-with-categorical-data?" class="md-nav__link">What is the problem with categorical data?</a>
        </li>
        <li class="md-nav__item"><a href="#How-to-convert-categorical-data-to-numerical-data?" class="md-nav__link">How to convert categorical data to numerical data?</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#The-One-Hot-Encoding-(OHE)-concept" class="md-nav__link">The <em>One-Hot Encoding</em> (OHE) concept</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Why-using-one-hot-encoding?" class="md-nav__link">Why using one-hot encoding?</a>
        </li>
        <li class="md-nav__item"><a href="#Example-of-one-hot-encoding" class="md-nav__link">Example of one-hot encoding</a>
        </li>
        <li class="md-nav__item"><a href="#Advantages-and-disadvantages-of-one-hot-encoding" class="md-nav__link">Advantages and disadvantages of one-hot encoding</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Similar:-Integer-or-label-encoding" class="md-nav__link">Similar: Integer or label encoding</a>
        </li>
        <li class="md-nav__item"><a href="#What-is-padding?" class="md-nav__link">What is <em>padding</em>?</a>
        </li>
        <li class="md-nav__item"><a href="#Further-readings" class="md-nav__link">Further readings</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Practical" class="md-nav__link">Practical</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Import-necessary-packages" class="md-nav__link">Import necessary packages</a>
        </li>
        <li class="md-nav__item"><a href="#Read-the-input-data" class="md-nav__link">Read the input data</a>
        </li>
        <li class="md-nav__item"><a href="#Process-the-data" class="md-nav__link">Process the data</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Double-digit-replacement" class="md-nav__link">Double digit replacement</a>
        </li>
        <li class="md-nav__item"><a href="#Compute-longest-(&amp;-shortest)-SMILES" class="md-nav__link">Compute longest (& shortest) SMILES</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Python-one-hot-encoding-implementation" class="md-nav__link">Python one-hot encoding implementation</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#One-hot-encode-(padding=True)" class="md-nav__link">One-hot encode (padding=True)</a>
        </li>
        <li class="md-nav__item"><a href="#Visualization" class="md-nav__link">Visualization</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Discussion" class="md-nav__link">Discussion</a>
        </li>
        <li class="md-nav__item"><a href="#Quiz" class="md-nav__link">Quiz</a>
        </li>
        <li class="md-nav__item"><a href="#Supplementary-material" class="md-nav__link">Supplementary material</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Scikit-learn-implementation-of-one-hot-encoding" class="md-nav__link">Scikit-learn implementation of one-hot encoding</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Without-padding-(unequal-dimension)" class="md-nav__link">Without padding (unequal dimension)</a>
        </li>
        <li class="md-nav__item"><a href="#With-padding-(equal-dimension)" class="md-nav__link">With padding (equal dimension)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Padding-after-one-hot-encoding-is-performed" class="md-nav__link">Padding after one-hot encoding is performed</a>
        </li>
        <li class="md-nav__item"><a href="#Padding-before-one-hot-encoding-is-performed" class="md-nav__link">Padding before one-hot encoding is performed</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Keras-implementation-of-one-hot-encoding" class="md-nav__link">Keras implementation of one-hot encoding</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id1" class="md-nav__link">Without padding (unequal dimension)</a>
        </li>
        <li class="md-nav__item"><a href="#id2" class="md-nav__link">With padding (equal dimension)</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/talktorials/T021_one_hot_encoding.nblink.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T022_ligand_based_screening_neural_network.html" class="md-nav__link">T022 · Ligand-based screening: neural networks</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T023_what_is_a_kinase.html" class="md-nav__link">T023 · What is a kinase?</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T024_kinase_similarity_sequence.html" class="md-nav__link">T024 · Kinase similarity: Sequence</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T025_kinase_similarity_kissim.html" class="md-nav__link">T025 · Kinase similarity: Kinase pocket (KiSSim fingerprint)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T026_kinase_similarity_ifp.html" class="md-nav__link">T026 · Kinase similarity: Interaction fingerprints</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T027_kinase_similarity_ligand_profile.html" class="md-nav__link">T027 · Kinase similarity: Ligand profile</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T028_kinase_similarity_compare_perspectives.html" class="md-nav__link">T028 · Kinase similarity: Compare different perspectives</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T033_molecular_representations.html" class="md-nav__link">T033 · Molecular representations</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T034_recurrent_neural_networks.html" class="md-nav__link">T034 · RNN-based molecular property prediction</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T035_graph_neural_networks.html" class="md-nav__link">T035 · GNN-based molecular property prediction</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T036_e3_equivariant_gnn.html" class="md-nav__link">T036 · An introduction to E(3)-invariant graph neural networks</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T037_uncertainty_estimation.html" class="md-nav__link">T037 · Uncertainty estimation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="T038_protein_ligand_interaction_prediction.html" class="md-nav__link">T038 · Protein Ligand Interaction Prediction</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html" class="md-nav__link">Talktorials by collection</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Run locally</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installing.html" class="md-nav__link">Installing</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Development</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../contribute.html" class="md-nav__link">For contributors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../api.html" class="md-nav__link">API Documentation</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">About TeachOpenCADD</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../contact.html" class="md-nav__link">Contact</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../acknowledgments.html" class="md-nav__link">Acknowledgments</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../citation.html" class="md-nav__link">Citation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../license.html" class="md-nav__link">License</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../funding.html" class="md-nav__link">Funding</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">External resources</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../external_dependencies.html" class="md-nav__link">Packages and webservers used in TeachOpenCADD</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../external_tutorials_collections.html" class="md-nav__link">External tutorials and collections</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#talktorials-t021-one-hot-encoding--page-root" class="md-nav__link">T021 · One-Hot Encoding</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Aim-of-this-talktorial" class="md-nav__link">Aim of this talktorial</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Contents-in-Theory" class="md-nav__link">Contents in <em>Theory</em></a>
        </li>
        <li class="md-nav__item"><a href="#Contents-in-Practical" class="md-nav__link">Contents in <em>Practical</em></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#References" class="md-nav__link">References</a>
        </li>
        <li class="md-nav__item"><a href="#Theory" class="md-nav__link">Theory</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Molecular-data-and-representation" class="md-nav__link">Molecular data and representation</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#ChEMBL-database" class="md-nav__link">ChEMBL database</a>
        </li>
        <li class="md-nav__item"><a href="#SMILES-structures-and-rules" class="md-nav__link">SMILES structures and rules</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#What-is-categorical-data?" class="md-nav__link">What is categorical data?</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#What-is-the-problem-with-categorical-data?" class="md-nav__link">What is the problem with categorical data?</a>
        </li>
        <li class="md-nav__item"><a href="#How-to-convert-categorical-data-to-numerical-data?" class="md-nav__link">How to convert categorical data to numerical data?</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#The-One-Hot-Encoding-(OHE)-concept" class="md-nav__link">The <em>One-Hot Encoding</em> (OHE) concept</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Why-using-one-hot-encoding?" class="md-nav__link">Why using one-hot encoding?</a>
        </li>
        <li class="md-nav__item"><a href="#Example-of-one-hot-encoding" class="md-nav__link">Example of one-hot encoding</a>
        </li>
        <li class="md-nav__item"><a href="#Advantages-and-disadvantages-of-one-hot-encoding" class="md-nav__link">Advantages and disadvantages of one-hot encoding</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Similar:-Integer-or-label-encoding" class="md-nav__link">Similar: Integer or label encoding</a>
        </li>
        <li class="md-nav__item"><a href="#What-is-padding?" class="md-nav__link">What is <em>padding</em>?</a>
        </li>
        <li class="md-nav__item"><a href="#Further-readings" class="md-nav__link">Further readings</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Practical" class="md-nav__link">Practical</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Import-necessary-packages" class="md-nav__link">Import necessary packages</a>
        </li>
        <li class="md-nav__item"><a href="#Read-the-input-data" class="md-nav__link">Read the input data</a>
        </li>
        <li class="md-nav__item"><a href="#Process-the-data" class="md-nav__link">Process the data</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Double-digit-replacement" class="md-nav__link">Double digit replacement</a>
        </li>
        <li class="md-nav__item"><a href="#Compute-longest-(&amp;-shortest)-SMILES" class="md-nav__link">Compute longest (& shortest) SMILES</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Python-one-hot-encoding-implementation" class="md-nav__link">Python one-hot encoding implementation</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#One-hot-encode-(padding=True)" class="md-nav__link">One-hot encode (padding=True)</a>
        </li>
        <li class="md-nav__item"><a href="#Visualization" class="md-nav__link">Visualization</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Discussion" class="md-nav__link">Discussion</a>
        </li>
        <li class="md-nav__item"><a href="#Quiz" class="md-nav__link">Quiz</a>
        </li>
        <li class="md-nav__item"><a href="#Supplementary-material" class="md-nav__link">Supplementary material</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Scikit-learn-implementation-of-one-hot-encoding" class="md-nav__link">Scikit-learn implementation of one-hot encoding</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Without-padding-(unequal-dimension)" class="md-nav__link">Without padding (unequal dimension)</a>
        </li>
        <li class="md-nav__item"><a href="#With-padding-(equal-dimension)" class="md-nav__link">With padding (equal dimension)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Padding-after-one-hot-encoding-is-performed" class="md-nav__link">Padding after one-hot encoding is performed</a>
        </li>
        <li class="md-nav__item"><a href="#Padding-before-one-hot-encoding-is-performed" class="md-nav__link">Padding before one-hot encoding is performed</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Keras-implementation-of-one-hot-encoding" class="md-nav__link">Keras implementation of one-hot encoding</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id1" class="md-nav__link">Without padding (unequal dimension)</a>
        </li>
        <li class="md-nav__item"><a href="#id2" class="md-nav__link">With padding (equal dimension)</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/talktorials/T021_one_hot_encoding.nblink.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="T021-·-One-Hot-Encoding">
<h1 id="talktorials-t021-one-hot-encoding--page-root">T021 · One-Hot Encoding<a class="headerlink" href="#talktorials-t021-one-hot-encoding--page-root" title="Permalink to this heading">¶</a></h1>
<p>Developed in the CADD seminar 2020, Volkamer Lab, Charité/FU Berlin</p>
<p><strong>Note:</strong> This talktorial is a part of TeachOpenCADD, a platform that aims to teach domain-specific skills and to provide pipeline templates as starting points for research projects.</p>
<p>Authors:</p>
<ul class="simple">
<li><p>Sakshi Misra, CADD seminar 2020, Charité/FU Berlin</p></li>
<li><p>Talia B. Kimber, 2020, <a class="reference external" href="https://volkamerlab.org">Volkamer lab</a>, Charité</p></li>
<li><p>Yonghui Chen, 2020, <a class="reference external" href="https://volkamerlab.org">Volkamer lab</a>, Charité</p></li>
<li><p>Andrea Volkamer, 2020, <a class="reference external" href="https://volkamerlab.org">Volkamer lab</a>, Charité</p></li>
</ul>
<section id="Aim-of-this-talktorial">
<h2 id="Aim-of-this-talktorial">Aim of this talktorial<a class="headerlink" href="#Aim-of-this-talktorial" title="Permalink to this heading">¶</a></h2>
<p>The aim of the talktorial is to perform one-hot encoding of SMILES structures on a subset of the ChEMBL data set to gain a deeper understanding on the one-hot encoding concept and why it is useful as a pre-processing step in various machine learning algorithms.</p>
<section id="Contents-in-Theory">
<h3 id="Contents-in-Theory">Contents in <em>Theory</em><a class="headerlink" href="#Contents-in-Theory" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Molecular data and representation</p>
<ul>
<li><p>ChEMBL database</p></li>
<li><p>SMILES structures and rules</p></li>
</ul>
</li>
<li><p>What is categorical data?</p>
<ul>
<li><p>What is the problem with categorical data?</p></li>
<li><p>How to convert categorical data to numerical data?</p></li>
</ul>
</li>
<li><p>The One-Hot Encoding (OHE) concept</p>
<ul>
<li><p>Why using one-hot encoding?</p></li>
<li><p>Example of one-hot encoding</p></li>
<li><p>Advantages and disadvantages of one-hot encoding</p></li>
</ul>
</li>
<li><p>Similar: Integer or label encoding</p></li>
<li><p>What is <em>padding</em>?</p></li>
<li><p>Further readings</p></li>
</ul>
</section>
<section id="Contents-in-Practical">
<h3 id="Contents-in-Practical">Contents in <em>Practical</em><a class="headerlink" href="#Contents-in-Practical" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Import necessary packages</p></li>
<li><p>Read the input data</p></li>
<li><p>Process the data</p>
<ul>
<li><p>Double digit replacement</p></li>
<li><p>Compute longest (&amp; shortest) SMILES</p></li>
</ul>
</li>
<li><p>Python one-hot encoding implementation</p>
<ul>
<li><p>One-hot encode (padding=True)</p></li>
<li><p>Visualization</p>
<ul>
<li><p>Shortest SMILES</p></li>
<li><p>Longest SMILES</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Supplementary material</p>
<ul>
<li><p>Scikit learn implementation</p></li>
<li><p>Keras implementation</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="References">
<h2 id="References">References<a class="headerlink" href="#References" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Theoretical background:</p>
<ul>
<li><p>ChEMBL database: “The ChEMBL bioactivity database: an update.” (<a class="reference external" href="https://doi.org/10.1093/nar/gkt1031">Nucleic acids research (2014), 42.D1, D1083-D1090</a>)</p></li>
<li><p>Allen Chieng Hoon Choong, Nung Kion Lee, “<em>Evaluation of Convolutionary Neural Networks Modeling of DNA Sequences using Ordinal versus one-hot Encoding Method</em>”, <a class="reference external" href="https://doi.org/10.1101/186965">bioRxiv, October 25, 2017</a>.</p></li>
<li><p>Patricio Cerda, Gael Varoquaux, “<em>Encoding high-cardinality string categorical variables</em>”, <a class="reference external" href="https://arxiv.org/pdf/1907.01860v5.pdf">arXiv:1907, 18 May 2020</a>.</p></li>
<li><p>Blogpost: Jason Brownlee, <em>How to One Hot Encode Sequence Data in Python</em>, <a class="reference external" href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/">Machine Learning Mastery, accessed November 9th, 2020</a>.</p></li>
<li><p>Blogpost: Krishna Kumar Mahto, <em>One-Hot-Encoding, Multicollinearity and the Dummy Variable Trap</em>, towardsdatascience, Available from <a class="reference external" href="https://towardsdatascience.com/one-hot-encoding-multicollinearity-and-the-dummy-variable-trap-b5840be3c41a/">one-hot-encoding-multicollinearity</a>, accessed July 8th, 2019.</p></li>
<li><p>Blogpost: Chris, <em>What is padding in a neural network?</em>, archieved from MachineCurve, <a class="reference external" href="https://github.com/christianversloot/machine-learning-articles/blob/main/what-is-padding-in-a-neural-network.md">Padding</a></p></li>
</ul>
</li>
<li><p>Packages and functions:</p>
<ul>
<li><p><a class="reference external" href="https://www.rdkit.org/docs/GettingStartedInPython.html">RDKit</a>: Greg Landrum, <em>RDKit Documentation</em>, <a class="reference external" href="https://buildmedia.readthedocs.org/media/pdf/rdkit/latest/rdkit.pdf">PDF</a>, Release on 2019.09.1.</p></li>
<li><p><a class="reference external" href="https://scikit-learn.org/stable/">Scikit-learn</a>:</p>
<ul>
<li><p><a class="reference external" href="https://jmlr.csail.mit.edu/papers/v12/pedregosa11a.html">Scikit-learn: Machine Learning in Python</a>, Pedregosa <em>et al.</em>, JMLR 12, pp. 2825-2830, 2011.</p></li>
<li><p>Jiangang Hao, et al. “A Review of Scikit-learn Package in Python Programming Language.” <a class="reference external" href="https://doi.org/10.3102/1076998619832248">Journal of Education and Behavioral Statistics Volume: 44 issue: 3 (2019), page(s): 348-361</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://keras.io/">Keras</a>: Book chapter: “An Introduction to Deep Learning and Keras” in <a class="reference external" href="https://doi.org/10.1007/978-1-4842-4240-7">Learn Keras for Deep Neural Networks (2019), page(s):1-16</a>.</p></li>
<li><p><a class="reference external" href="https://matplotlib.org/">Matplotlib</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">smiles</span> <span class="pre">encoder</span></code> function: Blogpost by iwatobipen, <em>encode and decode SMILES strings</em> , <a class="reference external" href="https://iwatobipen.wordpress.com/2017/01/22/encode-and-decode-smiles-strings/">Wordpress, accessed November 9th, 2020</a></p></li>
</ul>
</li>
</ul>
</section>
<section id="Theory">
<h2 id="Theory">Theory<a class="headerlink" href="#Theory" title="Permalink to this heading">¶</a></h2>
<section id="Molecular-data-and-representation">
<h3 id="Molecular-data-and-representation">Molecular data and representation<a class="headerlink" href="#Molecular-data-and-representation" title="Permalink to this heading">¶</a></h3>
<section id="ChEMBL-database">
<h4 id="ChEMBL-database">ChEMBL database<a class="headerlink" href="#ChEMBL-database" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://www.ebi.ac.uk/chembl/">ChEMBL</a> is an open large-scale bioactivity database, containing molecules with drug-like properties.</p></li>
<li><p>The recent release (version 25) contains information extracted from more than <span class="math notranslate nohighlight">\(72,000\)</span> documents. In total, there are now more than <span class="math notranslate nohighlight">\(1.8\)</span> million compounds and <span class="math notranslate nohighlight">\(15\)</span> million bioactivity data points available.</p></li>
<li><p>It is maintained by <a class="reference external" href="https://en.wikipedia.org/wiki/European_Bioinformatics_Institute">European Bioinformatics Institute</a>. Please refer to <strong>Talktorial T001</strong> for more details.</p></li>
</ul>
</section>
<section id="SMILES-structures-and-rules">
<h4 id="SMILES-structures-and-rules">SMILES structures and rules<a class="headerlink" href="#SMILES-structures-and-rules" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Simplified_molecular-input_line-entry_system">SMILES</a> (Simplified Molecular Input Line Entry System) notation is a chemical notation that allows a user to represent a chemical structure of a molecule in a linear way that can be read by the computer (see “Modern Aspects of the Smiles Rearrangement” (2017), <a class="reference external" href="https://doi.org/10.1002/chem.201700353">Chemistry A European Journal, Volume23, Issue38, 8992-9008</a> for further information).</p></li>
<li><p>It contains a sequence of letters, numbers and characters that specify a molecule’s atoms, their connectivity, bond order and chirality.</p></li>
</ul>
<p><strong>Some SMILES specification rules</strong></p>
<ul class="simple">
<li><p><strong>Atoms</strong> - are represented by their atomic symbols. Also metal atoms are represented with symbols in square bracket, e.g. Gold <code class="docutils literal notranslate"><span class="pre">[Au]</span></code>.</p></li>
<li><p><strong>Bonds</strong> - single, double and triple bonds are represented by symbols <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">=</span></code> and <code class="docutils literal notranslate"><span class="pre">#</span></code>, respectively. Single bonds are the default and therefore do not need to be specified.</p></li>
<li><p><strong>Aromaticity</strong> - While atomic symbols are generally used in upper case, such as <code class="docutils literal notranslate"><span class="pre">C</span></code>, <code class="docutils literal notranslate"><span class="pre">O</span></code>, <code class="docutils literal notranslate"><span class="pre">S</span></code> and <code class="docutils literal notranslate"><span class="pre">N</span></code>; to specify aromatic atoms lower case symbols are used instead, such as <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">o</span></code>, <code class="docutils literal notranslate"><span class="pre">s</span></code> and <code class="docutils literal notranslate"><span class="pre">n</span></code>. Sometimes implicit bonds in rings (alternating <code class="docutils literal notranslate"><span class="pre">=</span></code> and <code class="docutils literal notranslate"><span class="pre">-</span></code>) are also used to describe aromatic atoms such as <code class="docutils literal notranslate"><span class="pre">C1=CC=CC=C1</span></code>.</p></li>
<li><p><strong>Rings</strong> - SMILES allows a user to identify ring structures by using numbers to identify the opening and closing ring atom. For example, in <code class="docutils literal notranslate"><span class="pre">C1CCCCC1</span></code>, the first carbon has a number “1” which connects by a single bond with the last carbon which also has a number “1”. The resulting structure is cyclohexane.</p></li>
<li><p><strong>Branches</strong> - are specified by enclosing them in parentheses, and can be nested or arranged. For example, 2-Propanol is represented by <code class="docutils literal notranslate"><span class="pre">CC(O)C</span></code>.</p></li>
</ul>
</section>
</section>
<section id="What-is-categorical-data?">
<h3 id="What-is-categorical-data?">What is categorical data?<a class="headerlink" href="#What-is-categorical-data?" title="Permalink to this heading">¶</a></h3>
<p>Categorical data are variables that contain labels rather than numeric values. Some examples include:</p>
<ul class="simple">
<li><p>A “pet” variable with the values: “dog” and “cat”.</p></li>
<li><p>A “color” variable with the values: “red”, “green” and “blue”.</p></li>
<li><p>A “place” variable with the values: “first”, “second” and “third”.</p></li>
</ul>
<section id="What-is-the-problem-with-categorical-data?">
<h4 id="What-is-the-problem-with-categorical-data?">What is the problem with categorical data?<a class="headerlink" href="#What-is-the-problem-with-categorical-data?" title="Permalink to this heading">¶</a></h4>
<p>Machine learning consists of mathematical operations translated to a computer via low-level programming languages. Computers are brilliant when dealing with numbers. So we must somehow convert our input data to numbers. There are many machine learning algorithms which cannot operate on categorical data directly. Thus, categorical data must be converted to a numerical form, that all input and output variables are numeric (see
<a class="reference external" href="https://www.analyticsvidhya.com/blog/2020/03/one-hot-encoding-vs-label-encoding-using-scikit-learn/">Blogpost</a>: Alakh Sethi, <em>One-Hot Encoding vs. Label Encoding using Scikit-Learn</em> , Analytics Vidya, accessed March 6th, 2020 for further information).</p>
<img alt="Computer data" src="../_images/computer_data.jpeg"/>
<p><em>Figure 1</em>: Displays the categorical encoding required for computers to understand the input. The figure comes from this <a class="reference external" href="https://www.analyticsvidhya.com/blog/2020/03/one-hot-encoding-vs-label-encoding-using-scikit-learn/">blogpost</a>.</p>
</section>
<section id="How-to-convert-categorical-data-to-numerical-data?">
<h4 id="How-to-convert-categorical-data-to-numerical-data?">How to convert categorical data to numerical data?<a class="headerlink" href="#How-to-convert-categorical-data-to-numerical-data?" title="Permalink to this heading">¶</a></h4>
<p>There are many ways to convert categorical values into numerical values. Each approach has its own positive and negative impact on the feature set. Hereby, two main methods will be the focus: <em>One-hot</em> encoding and <em>Label</em> encoding. Both of these encoders are part of the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html">scikit-learn</a> library (one of the most widely used Python libraries) and are used to convert text or categorical data into numerical
data which the model expects and and can work with.</p>
</section>
</section>
<section id="The-One-Hot-Encoding-(OHE)-concept">
<h3 id="The-One-Hot-Encoding-(OHE)-concept">The <em>One-Hot Encoding</em> (OHE) concept<a class="headerlink" href="#The-One-Hot-Encoding-(OHE)-concept" title="Permalink to this heading">¶</a></h3>
<p>The one-hot encoding is a vector representation where all the elements of the vector are set to <code class="docutils literal notranslate"><span class="pre">0</span></code> except one, which has <code class="docutils literal notranslate"><span class="pre">1</span></code> as its value. For example, <code class="docutils literal notranslate"><span class="pre">[0</span> <span class="pre">0</span> <span class="pre">0</span> <span class="pre">1</span> <span class="pre">0</span> <span class="pre">0]</span></code> is a one-hot vector. Simply put, one-hot encoding, also known as binary encoding, is a binary representation of categorical variables as binary vectors.</p>
<p>The figure shown below helps us gain an overall idea of the one-hot encoding concept.</p>
<img alt="One Hot encoding" src="../_images/OneHotEncoding.png"/>
<p><em>Figure 2</em> : Displays the one-hot encoding of the toluene molecule. Figure taken from the article <a class="reference external" href="https://doi.org/10.1186/s12859-018-2523-5">BMC Bioinformatics. (2018), 19,526</a>, more information can be found there.</p>
<p>Let us take a deeper look into the concept with the help of a simple example that will describe the basic concept of one-hot encoding, why it is useful and how one can approach it.</p>
<section id="Why-using-one-hot-encoding?">
<h4 id="Why-using-one-hot-encoding?">Why using one-hot encoding?<a class="headerlink" href="#Why-using-one-hot-encoding?" title="Permalink to this heading">¶</a></h4>
<p>One-hot encoding allows the representation of categorical data to be more expressive. It is difficult for many machine learning algorithms to work with categorical data directly that’s why the label values which are categorical must be converted into numbers first as a preprocessing step. This is required for both input and output variables that are categorical.</p>
<p>We could also use an <em>integer encoding</em> directly. This may work for problems where there is a natural ordinal relationship between the categories, and in turn the integer values, such as labels for temperature “cold”, “warm”, and “hot”. There may be problems when there is no ordinal relationship and allowing the representation to lean on any such relationship by using integer encoding might be not useful to solve the problem. An example might be the labels “dog” and “cat”.</p>
</section>
<section id="Example-of-one-hot-encoding">
<h4 id="Example-of-one-hot-encoding">Example of one-hot encoding<a class="headerlink" href="#Example-of-one-hot-encoding" title="Permalink to this heading">¶</a></h4>
<p>Let us take a look at a very simple example to understand this concept. Assume we have the “color” variable which has three labels <code class="docutils literal notranslate"><span class="pre">red</span></code> , <code class="docutils literal notranslate"><span class="pre">blue</span></code> and <code class="docutils literal notranslate"><span class="pre">green</span></code>. All these labels must be converted into numeric form in order to work with our machine learning algorithm. This can be done by creating three new columns having all three labels and use <code class="docutils literal notranslate"><span class="pre">1</span></code> for the color of the respective label and <code class="docutils literal notranslate"><span class="pre">0</span></code> for the other colors as shown in Figure 4.</p>
<img alt="One Hot Encoding" src="../_images/OneHotEncoding_eg.png"/>
<p><em>Figure 3</em> : The visual demonstration of one-hot encoding done on the variable “color”. Figure taken from the article: “<em>Building a One Hot Encoding Layer with TensorFlow</em>”, George Novack, <a class="reference external" href="https://towardsdatascience.com/building-a-one-hot-encoding-layer-with-tensorflow-f907d686bf39">towardsdatascience</a>, more details can be found there.</p>
</section>
<section id="Advantages-and-disadvantages-of-one-hot-encoding">
<h4 id="Advantages-and-disadvantages-of-one-hot-encoding">Advantages and disadvantages of one-hot encoding<a class="headerlink" href="#Advantages-and-disadvantages-of-one-hot-encoding" title="Permalink to this heading">¶</a></h4>
<p><strong>Advantages</strong> - If the cardinality (the number of categories) of the categorical features is low (relative to the amount of data), one-hot encoding will work best. - One-hot encoding has the advantage that the result is binary rather than ordinal and that everything sits in an orthogonal vector space.</p>
<p><strong>Disadvantages</strong> - Increase in dimensionality, after adding several columns based on categorical variables which may result in an increase in the computational cost. - There is a high chance of multi-collinearity due to dummy variables (unique category added as a feature) which can affect the performance of the model. - One-hot encoding can result in increasing the <a class="reference external" href="https://en.wikipedia.org/wiki/Sparse_matrix">sparsity</a> of a data set (a sparse matrix is a matrix in which most of the elements
are zero).</p>
</section>
</section>
<section id="Similar:-Integer-or-label-encoding">
<h3 id="Similar:-Integer-or-label-encoding">Similar: Integer or label encoding<a class="headerlink" href="#Similar:-Integer-or-label-encoding" title="Permalink to this heading">¶</a></h3>
<p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html">Label Encoding</a>, or integer encoding, is a popular encoding technique for handling categorical variables and is easily reversible. In this technique, each label is assigned a unique integer based on alphabetical ordering, so that machines can work with it properly. Machine learning algorithms can then decide in a better way on how labels must be operated on. It is an important preprocessing step for
structured data sets in supervised learning.</p>
<p><strong>Example of integer encoding</strong></p>
<p>Let us use a similar example as above: We have a color variable and we can assign <code class="docutils literal notranslate"><span class="pre">red</span></code> as <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">green</span></code> as <code class="docutils literal notranslate"><span class="pre">1</span></code>, and <code class="docutils literal notranslate"><span class="pre">blue</span></code> as <code class="docutils literal notranslate"><span class="pre">2</span></code> as shown in Figure 5.</p>
<img alt="OneHotEncoding Example" src="../_images/label_encoding_example.png"/>
<p><em>Figure 5</em> : The visual demonstration of label encoding done on the variable “color”. Figure taken from the article: “<em>Know about Categorical Encoding, even New Ones!</em>”, Ahmed Othmen, <a class="reference external" href="https://towardsdatascience.com/know-about-categorical-encoding-even-new-ones-c266227b9cbd">towardsdatascience</a>, more details can be found there.</p>
<p><strong>Difference between label and one-hot encoding</strong></p>
<p>There is not much difference between these two encoding techniques, it mainly depends on the type of data and model used. For example, if we have categorical features which are not ordinal (dog or cat) then we can use one-hot encoding. Label encoding works best with ordinal data like <code class="docutils literal notranslate"><span class="pre">good=0,</span> <span class="pre">better=1,</span> <span class="pre">best=2</span></code>. Also when there are many categorical variables then it might be good to choose label encoding just to avoid high memory consumption and sparsity.</p>
</section>
<section id="What-is-padding?">
<h3 id="What-is-padding?">What is <em>padding</em>?<a class="headerlink" href="#What-is-padding?" title="Permalink to this heading">¶</a></h3>
<p>Padding is used to add zeros to the resulted one-hot encoded matrix. There are different types of padding, we chose to performed zero padding in here. For more details, please refer to this <a class="reference external" href="https://github.com/christianversloot/machine-learning-articles/blob/main/what-is-padding-in-a-neural-network.md">Article</a>.</p>
<p><strong>Why is it performed?</strong></p>
<p>Padding is performed to make the dimensions of the matrix equal - or to preserve the height and the width - and to not have to worry too much about tensor dimensions when used as an input for the deep learning models.</p>
<p><strong>How is it performed?</strong></p>
<p>Padding can be performed by using the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html">numpy.pad</a> function which takes several parameters like the <code class="docutils literal notranslate"><span class="pre">array</span></code> which needs to be padded, <code class="docutils literal notranslate"><span class="pre">pad_width</span></code> which is number of values added to the edges of each axis and <code class="docutils literal notranslate"><span class="pre">mode</span></code> which by default is “constant”.</p>
<p>In this talktorial, <em>padding</em> is performed</p>
<ul class="simple">
<li><p><em>implicitly</em>: when applying one-hot encoding using a python implementation on the preprocessed data, where we have given the maximum length of the string as the parameter so that all the resulting one-hot encoded matrices are of the same dimension</p></li>
<li><p><em>explicitly</em>: More info on this can be found in the <strong>supplementary section</strong>, where we apply one-hot encoding using <em>keras</em> and <em>scikit-learn</em> implementations.</p></li>
</ul>
</section>
<section id="Further-readings">
<h3 id="Further-readings">Further readings<a class="headerlink" href="#Further-readings" title="Permalink to this heading">¶</a></h3>
<p>This section lists some resources for further reading:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.quora.com/What-is-one-hot-encoding-and-when-is-it-used-in-data-science">What is one-hot encoding and when is it used in data science?</a></p></li>
<li><p><a class="reference external" href="https://towardsdatascience.com/categorical-encoding-using-label-encoding-and-one-hot-encoder-911ef77fb5bd#:~:text=One%2DHot%20Encoding%20in%20Python&amp;text=OneHotEncoder%20from%20SciKit%20library%20only,apply%20OneHotEncoder%20on%20column%20Bridge_Types_Cat.">Categorical encoding using Label-Encoding and One-Hot-Encoder</a></p></li>
<li><p>Hirohara, M., Saito, Y., Koda, Y. et al. Convolutional neural network based on SMILES representation of compounds for detecting chemical motif. <a class="reference external" href="https://doi.org/10.1186/s12859-018-2523-5">BMC Bioinformatics 19, 526 (2018)</a></p></li>
<li><p><a class="reference external" href="https://www.geeksforgeeks.org/matplotlib-pyplot-imshow-in-python/">How one can use matplotlib.pyplot.imshow() in Python</a></p></li>
</ul>
</section>
</section>
<section id="Practical">
<h2 id="Practical">Practical<a class="headerlink" href="#Practical" title="Permalink to this heading">¶</a></h2>
<section id="Import-necessary-packages">
<h3 id="Import-necessary-packages">Import necessary packages<a class="headerlink" href="#Import-necessary-packages" title="Permalink to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">filterwarnings</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">Draw</span><span class="p">,</span> <span class="n">PandasTools</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">to_categorical</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.preprocessing.text</span> <span class="kn">import</span> <span class="n">Tokenizer</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Silence some expected warnings</span>
<span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set path to this notebook</span>
<span class="n">HERE</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">_dh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">DATA</span> <span class="o">=</span> <span class="n">HERE</span> <span class="o">/</span> <span class="s2">"data"</span>
</pre></div>
</div>
</div>
</section>
<section id="Read-the-input-data">
<h3 id="Read-the-input-data">Read the input data<a class="headerlink" href="#Read-the-input-data" title="Permalink to this heading">¶</a></h3>
<p>Using the Pandas library, we first load the subset of the ChEMBL data set and draw the molecules using the <code class="docutils literal notranslate"><span class="pre">rdkit.draw</span></code> function. We then preprocess the data and apply our <code class="docutils literal notranslate"><span class="pre">one-hot</span> <span class="pre">encoding</span></code> python implementation.</p>
<p>Let’s load the data and quickly analyze its column values and check if there are any missing values:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">DATA</span> <span class="o">/</span> <span class="s2">"CHEMBL25_activities_EGFR.csv"</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Shape of dataframe: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Shape of dataframe: (3905, 5)

</pre></div></div>
</div>
<p>Check the dimension and missing value of the data</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 3905 entries, 0 to 3904
Data columns (total 5 columns):
 #   Column            Non-Null Count  Dtype
---  ------            --------------  -----
 0   chembl_id         3905 non-null   object
 1   IC50              3905 non-null   float64
 2   units             3905 non-null   object
 3   canonical_smiles  3905 non-null   object
 4   pIC50             3905 non-null   float64
dtypes: float64(2), object(3)
memory usage: 152.7+ KB
</pre></div></div>
</div>
<p>Look at the first 3 rows</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>chembl_id</th>
<th>IC50</th>
<th>units</th>
<th>canonical_smiles</th>
<th>pIC50</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL207869</td>
<td>77.0</td>
<td>nM</td>
<td>Clc1c(OCc2cc(F)ccc2)ccc(Nc2c(C#Cc3ncccn3)cncn2)c1</td>
<td>7.113509</td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL3940060</td>
<td>330.0</td>
<td>nM</td>
<td>ClCC(=O)OCCN1C(=O)Oc2c1cc1c(Nc3cc(Cl)c(F)cc3)n...</td>
<td>6.481486</td>
</tr>
<tr>
<th>2</th>
<td>CHEMBL3678951</td>
<td>1.0</td>
<td>nM</td>
<td>FC(F)(F)c1cc(Nc2n(C(C)C)c3nc(Nc4ccc(N5CC[NH+](...</td>
<td>9.000000</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<p>Select the columns which are necessary for our study</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">"chembl_id"</span><span class="p">,</span> <span class="s2">"canonical_smiles"</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<p>We can visualize the molecules with their ChEMBL ID using pandas tools and the <code class="docutils literal notranslate"><span class="pre">draw</span></code> method as shown below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using PandasTools and the respective Draw method</span>
<span class="n">PandasTools</span><span class="o">.</span><span class="n">AddMoleculeColumnToFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">smilesCol</span><span class="o">=</span><span class="s2">"canonical_smiles"</span><span class="p">,</span> <span class="n">molCol</span><span class="o">=</span><span class="s2">"Mol2D"</span><span class="p">)</span>
<span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Mol2D</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]),</span> <span class="n">legends</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">chembl_id</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">]),</span> <span class="n">molsPerRow</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T021_one_hot_encoding_35_0.png" src="../_images/talktorials_T021_one_hot_encoding_35_0.png"/>
</div>
</div>
</section>
<section id="Process-the-data">
<h3 id="Process-the-data">Process the data<a class="headerlink" href="#Process-the-data" title="Permalink to this heading">¶</a></h3>
<p>SMILES preprocessing: Since in SMILES representation, atoms can be described by one or two characters (depending on the periodic element they represent) while the machine will read the input position-wise, we convert the SMILES in a chemical-aware representation.</p>
<ul class="simple">
<li><p>First, we search for all unique characters present in the current data set, which allows us to remove the characters which are not present in the current data.</p></li>
<li><p>Second, we search for all double-character elements in our SMILES data set by comparing the atoms present in our strings with all the possible elements present in the periodic table and replacing all the two alphabetic elements by <em>artificially</em> selected characters, for example changing <code class="docutils literal notranslate"><span class="pre">Cl</span></code> to <code class="docutils literal notranslate"><span class="pre">L</span></code>.</p></li>
</ul>
<p>For padding:</p>
<ul class="simple">
<li><p>SMILES strings have unequal dimension since their string length differ. For machine learning application, having equal dimension throughout the data set is required. In order to achieve this, we can first search for the SMILES string with the maximum length (e.g. <a class="reference external" href="https://www.geeksforgeeks.org/python-string-length-len/">len()</a> method) and pass it as an argument in our function for all the strings.</p></li>
</ul>
<section id="Double-digit-replacement">
<h4 id="Double-digit-replacement">Double digit replacement<a class="headerlink" href="#Double-digit-replacement" title="Permalink to this heading">¶</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">assess_two_letter_elements</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Find the two letter elements in dataframe.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pandas.DataFrame</span>
<span class="sd">        Dataframe which requires preprocessing.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    two_letter_elements : list</span>
<span class="sd">        List with found two letter elements</span>
<span class="sd">    """</span>

    <span class="c1"># Search for unique characters in SMILES strings</span>
    <span class="n">unique_chars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">canonical_smiles</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="c1"># Get upper and lower case letters only</span>
    <span class="n">upper_chars</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">lower_chars</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">unique_chars</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
                <span class="n">upper_chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">entry</span><span class="o">.</span><span class="n">islower</span><span class="p">():</span>
                <span class="n">lower_chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Upper letter characters </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">upper_chars</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Lower letter characters </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">lower_chars</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1"># List of all possible periodic elements</span>
    <span class="n">periodic_elements</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">"Ac"</span><span class="p">,</span>
        <span class="s2">"Al"</span><span class="p">,</span>
        <span class="s2">"Am"</span><span class="p">,</span>
        <span class="s2">"Sb"</span><span class="p">,</span>
        <span class="s2">"Ar"</span><span class="p">,</span>
        <span class="s2">"As"</span><span class="p">,</span>
        <span class="s2">"At"</span><span class="p">,</span>
        <span class="s2">"Ba"</span><span class="p">,</span>
        <span class="s2">"Bk"</span><span class="p">,</span>
        <span class="s2">"Be"</span><span class="p">,</span>
        <span class="s2">"Bi"</span><span class="p">,</span>
        <span class="s2">"Bh"</span><span class="p">,</span>
        <span class="s2">"B"</span><span class="p">,</span>
        <span class="s2">"Br"</span><span class="p">,</span>
        <span class="s2">"Cd"</span><span class="p">,</span>
        <span class="s2">"Ca"</span><span class="p">,</span>
        <span class="s2">"Cf"</span><span class="p">,</span>
        <span class="s2">"C"</span><span class="p">,</span>
        <span class="s2">"Ce"</span><span class="p">,</span>
        <span class="s2">"Cs"</span><span class="p">,</span>
        <span class="s2">"Cl"</span><span class="p">,</span>
        <span class="s2">"Cr"</span><span class="p">,</span>
        <span class="s2">"Co"</span><span class="p">,</span>
        <span class="s2">"Cn"</span><span class="p">,</span>
        <span class="s2">"Cu"</span><span class="p">,</span>
        <span class="s2">"Cm"</span><span class="p">,</span>
        <span class="s2">"Ds"</span><span class="p">,</span>
        <span class="s2">"Db"</span><span class="p">,</span>
        <span class="s2">"Dy"</span><span class="p">,</span>
        <span class="s2">"Es"</span><span class="p">,</span>
        <span class="s2">"Er"</span><span class="p">,</span>
        <span class="s2">"Eu"</span><span class="p">,</span>
        <span class="s2">"Fm"</span><span class="p">,</span>
        <span class="s2">"Fl"</span><span class="p">,</span>
        <span class="s2">"F"</span><span class="p">,</span>
        <span class="s2">"Fr"</span><span class="p">,</span>
        <span class="s2">"Gd"</span><span class="p">,</span>
        <span class="s2">"Ga"</span><span class="p">,</span>
        <span class="s2">"Ge"</span><span class="p">,</span>
        <span class="s2">"Au"</span><span class="p">,</span>
        <span class="s2">"Hf"</span><span class="p">,</span>
        <span class="s2">"Hs"</span><span class="p">,</span>
        <span class="s2">"He"</span><span class="p">,</span>
        <span class="s2">"Ho"</span><span class="p">,</span>
        <span class="s2">"H"</span><span class="p">,</span>
        <span class="s2">"In"</span><span class="p">,</span>
        <span class="s2">"I"</span><span class="p">,</span>
        <span class="s2">"Ir"</span><span class="p">,</span>
        <span class="s2">"Fe"</span><span class="p">,</span>
        <span class="s2">"Kr"</span><span class="p">,</span>
        <span class="s2">"La"</span><span class="p">,</span>
        <span class="s2">"Lr"</span><span class="p">,</span>
        <span class="s2">"Pb"</span><span class="p">,</span>
        <span class="s2">"Li"</span><span class="p">,</span>
        <span class="s2">"Lv"</span><span class="p">,</span>
        <span class="s2">"Lu"</span><span class="p">,</span>
        <span class="s2">"Mg"</span><span class="p">,</span>
        <span class="s2">"Mn"</span><span class="p">,</span>
        <span class="s2">"Mt"</span><span class="p">,</span>
        <span class="s2">"Md"</span><span class="p">,</span>
        <span class="s2">"Hg"</span><span class="p">,</span>
        <span class="s2">"Mo"</span><span class="p">,</span>
        <span class="s2">"Mc"</span><span class="p">,</span>
        <span class="s2">"Nd"</span><span class="p">,</span>
        <span class="s2">"Ne"</span><span class="p">,</span>
        <span class="s2">"Np"</span><span class="p">,</span>
        <span class="s2">"Ni"</span><span class="p">,</span>
        <span class="s2">"Nh"</span><span class="p">,</span>
        <span class="s2">"Nb"</span><span class="p">,</span>
        <span class="s2">"N"</span><span class="p">,</span>
        <span class="s2">"No"</span><span class="p">,</span>
        <span class="s2">"Og"</span><span class="p">,</span>
        <span class="s2">"Os"</span><span class="p">,</span>
        <span class="s2">"O"</span><span class="p">,</span>
        <span class="s2">"Pd"</span><span class="p">,</span>
        <span class="s2">"P"</span><span class="p">,</span>
        <span class="s2">"Pt"</span><span class="p">,</span>
        <span class="s2">"Pu"</span><span class="p">,</span>
        <span class="s2">"Po"</span><span class="p">,</span>
        <span class="s2">"K"</span><span class="p">,</span>
        <span class="s2">"Pr"</span><span class="p">,</span>
        <span class="s2">"Pm"</span><span class="p">,</span>
        <span class="s2">"Pa"</span><span class="p">,</span>
        <span class="s2">"Ra"</span><span class="p">,</span>
        <span class="s2">"Rn"</span><span class="p">,</span>
        <span class="s2">"Re"</span><span class="p">,</span>
        <span class="s2">"Rh"</span><span class="p">,</span>
        <span class="s2">"Rg"</span><span class="p">,</span>
        <span class="s2">"Rb"</span><span class="p">,</span>
        <span class="s2">"Ru"</span><span class="p">,</span>
        <span class="s2">"Rf"</span><span class="p">,</span>
        <span class="s2">"Sm"</span><span class="p">,</span>
        <span class="s2">"Sc"</span><span class="p">,</span>
        <span class="s2">"Sg"</span><span class="p">,</span>
        <span class="s2">"Se"</span><span class="p">,</span>
        <span class="s2">"Si"</span><span class="p">,</span>
        <span class="s2">"Ag"</span><span class="p">,</span>
        <span class="s2">"Na"</span><span class="p">,</span>
        <span class="s2">"Sr"</span><span class="p">,</span>
        <span class="s2">"S"</span><span class="p">,</span>
        <span class="s2">"Ta"</span><span class="p">,</span>
        <span class="s2">"Tc"</span><span class="p">,</span>
        <span class="s2">"Te"</span><span class="p">,</span>
        <span class="s2">"Ts"</span><span class="p">,</span>
        <span class="s2">"Tb"</span><span class="p">,</span>
        <span class="s2">"Tl"</span><span class="p">,</span>
        <span class="s2">"Th"</span><span class="p">,</span>
        <span class="s2">"Tm"</span><span class="p">,</span>
        <span class="s2">"Sn"</span><span class="p">,</span>
        <span class="s2">"Ti"</span><span class="p">,</span>
        <span class="s2">"W"</span><span class="p">,</span>
        <span class="s2">"U"</span><span class="p">,</span>
        <span class="s2">"V"</span><span class="p">,</span>
        <span class="s2">"Xe"</span><span class="p">,</span>
        <span class="s2">"Yb"</span><span class="p">,</span>
        <span class="s2">"Y"</span><span class="p">,</span>
        <span class="s2">"Zn"</span><span class="p">,</span>
        <span class="s2">"Zr"</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="c1"># The two_char_elements list contains all two letter elements</span>
    <span class="c1"># which can be generated by all possible combination of upper x lower characters</span>
    <span class="c1"># and are valid periodic elements.</span>
    <span class="n">two_char_elements</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">upper</span> <span class="ow">in</span> <span class="n">upper_chars</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">lower</span> <span class="ow">in</span> <span class="n">lower_chars</span><span class="p">:</span>
            <span class="n">ch</span> <span class="o">=</span> <span class="n">upper</span> <span class="o">+</span> <span class="n">lower</span>
            <span class="k">if</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">periodic_elements</span><span class="p">:</span>
                <span class="n">two_char_elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>

    <span class="c1"># This list is then reduced to the subset of two-letter elements</span>
    <span class="c1"># that actually appear in the SMILES strings, specific to our data set.</span>
    <span class="n">two_char_elements_smiles</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">two_char_elements</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">canonical_smiles</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">char</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">two_char_elements_smiles</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">two_char_elements_smiles</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elements_found</span> <span class="o">=</span> <span class="n">assess_two_letter_elements</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Two letter elements found in the data set: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">elements_found</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Upper letter characters ['B', 'C', 'F', 'H', 'I', 'N', 'O', 'P', 'S']
Lower letter characters ['c', 'e', 'l', 'n', 'o', 'r', 's']

Two letter elements found in the data set: ['Br', 'Cl', 'Cn', 'Sc', 'Se']
</pre></div></div>
</div>
<p>Based on this finding, we defined our own dictionary for replacement. Note that their are several shortcomings with this <em>simple</em> implementation that we (partially) manually address here:</p>
<ul class="simple">
<li><p>We exclude <code class="docutils literal notranslate"><span class="pre">Sc</span></code> and <code class="docutils literal notranslate"><span class="pre">Cn</span></code> from the replacement, since it is more likely that sulfur <code class="docutils literal notranslate"><span class="pre">S</span></code> and an aromatic carbon <code class="docutils literal notranslate"><span class="pre">c</span></code> are contained in a molecule than scandium <code class="docutils literal notranslate"><span class="pre">Sc</span></code>, same for carbon <code class="docutils literal notranslate"><span class="pre">C</span></code> and an aromatic nitrogen <code class="docutils literal notranslate"><span class="pre">n</span></code> over Copernicium <code class="docutils literal notranslate"><span class="pre">Cn</span></code>. Thus, only the elements chlorine <code class="docutils literal notranslate"><span class="pre">Cl</span></code>, bromine <code class="docutils literal notranslate"><span class="pre">Br</span></code> and selenium <code class="docutils literal notranslate"><span class="pre">Se</span></code> are replaced.</p></li>
<li><p>In isomeric SMILES <code class="docutils literal notranslate"><span class="pre">@</span></code> and <code class="docutils literal notranslate"><span class="pre">@@</span></code> are used to describe enantiomers, thus we also need to replace the latter by a one letter code.</p></li>
<li><p>If you are working wit a different data set, you may want to adapt the below mapping dictionary.</p></li>
</ul>
<p>This resulted in the following dictionary to replace the two letter elements found in this data set</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">replace_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"Cl"</span><span class="p">:</span> <span class="s2">"L"</span><span class="p">,</span> <span class="s2">"Br"</span><span class="p">:</span> <span class="s2">"R"</span><span class="p">,</span> <span class="s2">"Se"</span><span class="p">:</span> <span class="s2">"X"</span><span class="p">,</span> <span class="s2">"@@"</span><span class="p">:</span> <span class="s2">"Z"</span><span class="p">}</span>
</pre></div>
</div>
</div>
<p>Based on this dictionary, we define a function to create the preprocessed data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">preprocessing_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">replacement</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Preprocess the SMILES structures in a data set.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pandas.DataFrame</span>
<span class="sd">      Dataframe which requires preprocessing.</span>
<span class="sd">    replacement : dict</span>
<span class="sd">      Dictionary with mapping for replacement.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df : pandas.DataFrame</span>
<span class="sd">        Dataframe with new processed canonical SMILES column.</span>
<span class="sd">    unique_char : list</span>
<span class="sd">        List with unique characters present in SMILES.</span>
<span class="sd">    """</span>
    <span class="c1"># Print warning if the data set has a 'Sc' element</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">canonical_smiles</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">"Sc"</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s1">'Warning: "Sc" element is found in the data set, since the element is rarely found '</span>
            <span class="s2">"in the drugs so we are not converting  "</span>
            <span class="s1">'it to single letter element, instead considering "S" '</span>
            <span class="s1">'and "c" as separate elements. '</span>
        <span class="p">)</span>

    <span class="c1"># Create a new column having processed canonical SMILES</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">"processed_canonical_smiles"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">"canonical_smiles"</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Replace the two letter elements found with one character</span>
    <span class="k">for</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">repl</span> <span class="ow">in</span> <span class="n">replacement</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">"processed_canonical_smiles"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">"processed_canonical_smiles"</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="n">pattern</span><span class="p">,</span> <span class="n">repl</span>
        <span class="p">)</span>

    <span class="n">unique_char</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">processed_canonical_smiles</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">unique_char</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calling function</span>
<span class="n">df</span><span class="p">,</span> <span class="n">unique_char</span> <span class="o">=</span> <span class="n">preprocessing_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">replace_dict</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Warning: "Sc" element is found in the data set, since the element is rarely found in the drugs so we are not converting  it to single letter element, instead considering "S" and "c" as separate elements.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>chembl_id</th>
<th>canonical_smiles</th>
<th>Mol2D</th>
<th>processed_canonical_smiles</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL207869</td>
<td>Clc1c(OCc2cc(F)ccc2)ccc(Nc2c(C#Cc3ncccn3)cncn2)c1</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f824651b200&gt;</td>
<td>Lc1c(OCc2cc(F)ccc2)ccc(Nc2c(C#Cc3ncccn3)cncn2)c1</td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL3940060</td>
<td>ClCC(=O)OCCN1C(=O)Oc2c1cc1c(Nc3cc(Cl)c(F)cc3)n...</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f824651b580&gt;</td>
<td>LCC(=O)OCCN1C(=O)Oc2c1cc1c(Nc3cc(L)c(F)cc3)ncn...</td>
</tr>
<tr>
<th>2</th>
<td>CHEMBL3678951</td>
<td>FC(F)(F)c1cc(Nc2n(C(C)C)c3nc(Nc4ccc(N5CC[NH+](...</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f824651b6d0&gt;</td>
<td>FC(F)(F)c1cc(Nc2n(C(C)C)c3nc(Nc4ccc(N5CC[NH+](...</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print unique characters</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"All unique characters found in the preprocessed data set:</span><span class="se">\n</span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">unique_char</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
All unique characters found in the preprocessed data set:
['#', '(', ')', '+', '-', '/', '0', '1', '2', '3', '4', '5', '6', '7', '=', '@', 'B', 'C', 'F', 'H', 'I', 'L', 'N', 'O', 'P', 'R', 'S', 'X', 'Z', '[', '\\', ']', 'c', 'n', 'o', 's']
</pre></div></div>
</div>
</section>
<section id="Compute-longest-(&amp;-shortest)-SMILES">
<h4 id="Compute-longest-(&amp;-shortest)-SMILES">Compute longest (&amp; shortest) SMILES<a class="headerlink" href="#Compute-longest-(&amp;-shortest)-SMILES" title="Permalink to this heading">¶</a></h4>
<p>Here, we compute the length and the indices in the data frame of the longest and shortest SMILES, which we will use later in the sections for visualization purpose.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Index of the longest SMILES string</span>
<span class="n">longest_smiles</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">"canonical_smiles"</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">)</span>
<span class="n">longest_smiles_index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">canonical_smiles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">canonical_smiles</span> <span class="o">==</span> <span class="n">longest_smiles</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Longest SMILES: </span><span class="si">{</span><span class="n">longest_smiles</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">longest_smiles</span><span class="p">)</span><span class="si">}</span><span class="s2"> characters, index in dataframe: </span><span class="si">{</span><span class="n">longest_smiles_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">."</span><span class="p">)</span>
<span class="n">smiles_maxlen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">longest_smiles</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Longest SMILES: O=C(N[C@@H]1C(=O)N[C@H](CCC[NH3+])C(=O)N[C@@H]([C@H](CC)C)C(=O)N[C@H](Cc2ccccc2)C(=O)N[C@@H](Cc2[nH]cnc2)C(=O)N[C@H](CC(=O)[O-])C(=O)N[C@@H](CC(=O)N)C(=O)NCCCC1)[C@@H](NC(=O)[C@H](NC(=O)[C@@H](NC(=O)[C@H]1N=C([C@@H]([NH3+])[C@H](CC)C)SC1)CC(C)C)CCC(=O)[O-])[C@H](CC)C
Contains 267 characters, index in dataframe: 2704.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Index of the shortest SMILES string</span>
<span class="n">shortest_smiles</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">"canonical_smiles"</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">)</span>
<span class="n">shortest_smiles_index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">canonical_smiles</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">canonical_smiles</span> <span class="o">==</span> <span class="n">shortest_smiles</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Shortest SMILES: </span><span class="si">{</span><span class="n">shortest_smiles</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">"Contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">shortest_smiles</span><span class="p">)</span><span class="si">}</span><span class="s2"> characters, index in dataframe: </span><span class="si">{</span><span class="n">shortest_smiles_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">."</span>
<span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Shortest SMILES: Oc1c(O)cccc1
Contains 12 characters, index in dataframe: 3428.
</pre></div></div>
</div>
</section>
</section>
<section id="Python-one-hot-encoding-implementation">
<h3 id="Python-one-hot-encoding-implementation">Python one-hot encoding implementation<a class="headerlink" href="#Python-one-hot-encoding-implementation" title="Permalink to this heading">¶</a></h3>
<section id="One-hot-encode-(padding=True)">
<h4 id="One-hot-encode-(padding=True)">One-hot encode (padding=True)<a class="headerlink" href="#One-hot-encode-(padding=True)" title="Permalink to this heading">¶</a></h4>
<p>We define a function <code class="docutils literal notranslate"><span class="pre">smiles_encoder</span></code> that takes SMILES, the maximum length of the SMILES string (<code class="docutils literal notranslate"><span class="pre">max_len</span></code>) for padding and the list of unique characters (<code class="docutils literal notranslate"><span class="pre">unique_char</span></code>) present in the <code class="docutils literal notranslate"><span class="pre">processed_canonical_smiles</span></code> column; and returns the one-hot encoded matrix of fixed shape.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function defined to create one-hot encoded matrix</span>
<span class="k">def</span> <span class="nf">smiles_encoder</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">max_len</span><span class="p">,</span> <span class="n">unique_char</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Function defined using all unique characters in our</span>
<span class="sd">    processed canonical SMILES structures created</span>
<span class="sd">    with the preprocessing_data function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    smiles : str</span>
<span class="sd">         SMILES of a molecule in string format.</span>
<span class="sd">    unique_char : list</span>
<span class="sd">         List of unique characters in the string data set.</span>
<span class="sd">    max_len : int</span>
<span class="sd">         Maximum length of the SMILES string.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    smiles_matrix : numpy.ndarray</span>
<span class="sd">         One-hot encoded matrix of fixed shape</span>
<span class="sd">         (unique char in smiles, max SMILES length).</span>
<span class="sd">    """</span>
    <span class="c1"># create dictionary of the unique char data set</span>
    <span class="n">smi2index</span> <span class="o">=</span> <span class="p">{</span><span class="n">char</span><span class="p">:</span> <span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">unique_char</span><span class="p">)}</span>
    <span class="c1"># one-hot encoding</span>
    <span class="c1"># zero padding to max_len</span>
    <span class="n">smiles_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_char</span><span class="p">),</span> <span class="n">max_len</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">smiles</span><span class="p">):</span>
        <span class="n">smiles_matrix</span><span class="p">[</span><span class="n">smi2index</span><span class="p">[</span><span class="n">char</span><span class="p">],</span> <span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">smiles_matrix</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply the function to the processed canonical SMILES strings</span>
<span class="n">df</span><span class="p">[</span><span class="s2">"unique_char_ohe_matrix"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">"processed_canonical_smiles"</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="n">smiles_encoder</span><span class="p">,</span> <span class="n">max_len</span><span class="o">=</span><span class="n">smiles_maxlen</span><span class="p">,</span> <span class="n">unique_char</span><span class="o">=</span><span class="n">unique_char</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>chembl_id</th>
<th>canonical_smiles</th>
<th>Mol2D</th>
<th>processed_canonical_smiles</th>
<th>unique_char_ohe_matrix</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL207869</td>
<td>Clc1c(OCc2cc(F)ccc2)ccc(Nc2c(C#Cc3ncccn3)cncn2)c1</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f824651b200&gt;</td>
<td>Lc1c(OCc2cc(F)ccc2)ccc(Nc2c(C#Cc3ncccn3)cncn2)c1</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL3940060</td>
<td>ClCC(=O)OCCN1C(=O)Oc2c1cc1c(Nc3cc(Cl)c(F)cc3)n...</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f824651b580&gt;</td>
<td>LCC(=O)OCCN1C(=O)Oc2c1cc1c(Nc3cc(L)c(F)cc3)ncn...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
</tr>
<tr>
<th>2</th>
<td>CHEMBL3678951</td>
<td>FC(F)(F)c1cc(Nc2n(C(C)C)c3nc(Nc4ccc(N5CC[NH+](...</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f824651b6d0&gt;</td>
<td>FC(F)(F)c1cc(Nc2n(C(C)C)c3nc(Nc4ccc(N5CC[NH+](...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</section>
<section id="Visualization">
<h4 id="Visualization">Visualization<a class="headerlink" href="#Visualization" title="Permalink to this heading">¶</a></h4>
<p>Matplotlib is a plotting library for the python programming language and Pyplot is a state-based interface to a matplotlib module which provides a MATLAB-like interface. The <a class="reference external" href="https://matplotlib.org/3.2.1/api/_as_gen/matplotlib.pyplot.imshow.html">imshow</a> function in the pyplot module of the matplotlib library is used to display data as an image i.e. on a 2D space.</p>
<p>We now visualize our one-hot encoded matrix using <code class="docutils literal notranslate"><span class="pre">imshow</span></code> by defining the <code class="docutils literal notranslate"><span class="pre">one_hot_matrix_plot</span></code> function as shown below.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">one_hot_matrix_plot</span><span class="p">(</span><span class="n">ohe_matrix</span><span class="p">,</span> <span class="n">smiles_char</span><span class="p">,</span> <span class="n">smiles</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Visualize one-hot encoded matrix</span>
<span class="sd">    using matplotlib imshow() function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ohe_matrix : numpy.ndarray</span>
<span class="sd">       One-hot encoded (ohe) matrix of shape</span>
<span class="sd">       (`smiles_char`, `len(smiles)`).</span>
<span class="sd">    smiles_char : list</span>
<span class="sd">        List of all possible SMILES characters.</span>
<span class="sd">    smiles : string</span>
<span class="sd">        Original SMILES string of respective molecule.</span>

<span class="sd">    Returns</span>
<span class="sd">    ------</span>
<span class="sd">    None</span>

<span class="sd">    """</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ohe_matrix</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"hot"</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s2">"None"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Length of SMILES string"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Char in SMILES (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">smiles_char</span><span class="p">)</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Visualization of one-hot encoded matrix"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Shape of one-hot matrix : "</span><span class="p">,</span> <span class="n">ohe_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Associated canonical SMILES: "</span><span class="p">,</span> <span class="n">smiles</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pass the index of the longest SMILES string to visualize the matrix</span>
<span class="n">one_hot_matrix_plot</span><span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">longest_smiles_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">"unique_char_ohe_matrix"</span><span class="p">],</span> <span class="n">unique_char</span><span class="p">,</span> <span class="n">longest_smiles</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T021_one_hot_encoding_57_0.png" src="../_images/talktorials_T021_one_hot_encoding_57_0.png"/>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Shape of one-hot matrix :  (36, 267)
Associated canonical SMILES:  O=C(N[C@@H]1C(=O)N[C@H](CCC[NH3+])C(=O)N[C@@H]([C@H](CC)C)C(=O)N[C@H](Cc2ccccc2)C(=O)N[C@@H](Cc2[nH]cnc2)C(=O)N[C@H](CC(=O)[O-])C(=O)N[C@@H](CC(=O)N)C(=O)NCCCC1)[C@@H](NC(=O)[C@H](NC(=O)[C@@H](NC(=O)[C@H]1N=C([C@@H]([NH3+])[C@H](CC)C)SC1)CC(C)C)CCC(=O)[O-])[C@H](CC)C
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Draw the molecules with the longest SMILES</span>
<span class="n">longest_smiles_mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">longest_smiles</span><span class="p">)</span>
<span class="n">longest_smiles_mol</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T021_one_hot_encoding_58_0.png" src="../_images/talktorials_T021_one_hot_encoding_58_0.png"/>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pass the index of the shortest SMILES string to visualize the matrix</span>
<span class="n">one_hot_matrix_plot</span><span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">shortest_smiles_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">"unique_char_ohe_matrix"</span><span class="p">],</span> <span class="n">unique_char</span><span class="p">,</span> <span class="n">shortest_smiles</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T021_one_hot_encoding_59_0.png" src="../_images/talktorials_T021_one_hot_encoding_59_0.png"/>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Shape of one-hot matrix :  (36, 267)
Associated canonical SMILES:  Oc1c(O)cccc1
</pre></div></div>
</div>
<p>From above, the matrix visualization was performed using matplotlib <code class="docutils literal notranslate"><span class="pre">imshow</span></code> function, we can also visualize the entire matrix using the <code class="docutils literal notranslate"><span class="pre">numpy.matrix</span></code> function, e.g. the one-hot encoded matrix of the longest SMILES string as shown below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Draw the molecules with the shortest SMILES</span>
<span class="n">shortest_smiles_mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">shortest_smiles</span><span class="p">)</span>
<span class="n">shortest_smiles_mol</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T021_one_hot_encoding_61_0.png" src="../_images/talktorials_T021_one_hot_encoding_61_0.png"/>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the some rows of the matrix for the molecule with the longest smiles</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
<span class="n">subset</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">unique_char</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">unique_char</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">"First </span><span class="si">{</span><span class="n">subset</span><span class="si">}</span><span class="s2"> rows of the ohe matrix, representing the characters </span><span class="si">{</span><span class="n">unique_char</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">subset</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">longest_smiles_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s2">"unique_char_ohe_matrix"</span><span class="p">])[</span><span class="mi">0</span><span class="p">:</span><span class="n">subset</span><span class="p">,</span> <span class="p">:])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
First 3 rows of the ohe matrix, representing the characters ['-', ')', 'L']

[[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
  0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0.
  1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
  0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 1. 0. 0.
  0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.
  0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0.]]
</pre></div></div>
</div>
</section>
</section>
</section>
<section id="Discussion">
<h2 id="Discussion">Discussion<a class="headerlink" href="#Discussion" title="Permalink to this heading">¶</a></h2>
<p>In the fields of computer aided drug discovery and development, machine learning techniques have been used for the development of novel drug candidates. The methods for designing drug targets and novel drug discovery now oftenly combine machine learning and deep learning algorithms to enhance the efficiency, efficacy, and quality of developed outputs.</p>
<p>But to work with any machine learning or deep learning algorithms, the input data should be in machine readable format. In computed-aided drug design, we mainly deal with the categorical or textual data where we work with drug molecules which are represented in SMILES string format, therefore we have to convert these categorical data to a numerical format.</p>
<p><strong>One-hot encoding</strong> is one of the popular and efficient encoding technique which converts the data to a numerical format. It can be used an important preprocessing steps before applying any machine learning or deep learning algorithms.</p>
<p>In this talktorial, we have applied one hot encoding after preprocessing the data to overcome some of the shortcomings such as:</p>
<ul class="simple">
<li><p>Make equal dimension of the one-hot encoded matrices because SMILES strings could have unequal dimension since their string length might differ and for most machine learning application having equal dimension throughout the data set is required.</p></li>
<li><p>Replacing two character element such as <code class="docutils literal notranslate"><span class="pre">Cl</span></code> to a single character because while one-hot encoding, it would split <code class="docutils literal notranslate"><span class="pre">Cl</span></code> into two characters, namely <code class="docutils literal notranslate"><span class="pre">C</span></code> and <code class="docutils literal notranslate"><span class="pre">l</span></code>, and that could lead to discrepancies.</p></li>
<li><p>Looking for unique characters in the data set to produce less sparse one-hot encoded matrices.</p></li>
</ul>
<p>One-hot encoding has several applications in various fields such as:</p>
<ul class="simple">
<li><p><strong>Machine learning (neural networks)</strong>: In machine learning , one-hot encoding is a frequently used method to deal with categorical data because many machine learning models need their input variables to be numeric.</p></li>
<li><p><strong>Natural language processing (NLP)</strong>: For NLP, most of the times data consists of corpus of words which is categorical in nature. Consider we have vocabulary of size <span class="math notranslate nohighlight">\(N\)</span>. In the one-hot encoding technique, we map the words to the vectors of length <span class="math notranslate nohighlight">\(n\)</span>, where the <span class="math notranslate nohighlight">\(n\)</span>th digit is an indicator of the presence of the particular word. The <span class="math notranslate nohighlight">\(n\)</span>th bit of each vector indicates the presence of the <span class="math notranslate nohighlight">\(n\)</span>th word in the vocabulary. For example if we are converting words
to the one-hot encoding format, then we will see vectors such as <span class="math notranslate nohighlight">\([0000\dots 100], [0000\dots 010], [0000\dots 001]\)</span>, and so on. Using this technique normal sentences can be represented as vectors and numerical operations can be then performed on this vector form.</p></li>
</ul>
</section>
<section id="Quiz">
<h2 id="Quiz">Quiz<a class="headerlink" href="#Quiz" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Why is it required to have equal dimensions of the one-hot encoded matrix?</p></li>
<li><p>Is there any other way to pre-process the data?</p></li>
<li><p>How and which machine learning models can be applied on the above data set?</p></li>
</ul>
</section>
<section id="Supplementary-material">
<h2 id="Supplementary-material">Supplementary material<a class="headerlink" href="#Supplementary-material" title="Permalink to this heading">¶</a></h2>
<p>If you are interested in other implementations of one-hot encoding, please keep reading this section. This includes:</p>
<ul class="simple">
<li><p>Exploring <strong>scikit-learn</strong> and <strong>keras</strong> implementations of one-hot encoding.</p></li>
<li><p>Performing <strong>padding</strong> before and after one-hot encoding.</p></li>
</ul>
<section id="Scikit-learn-implementation-of-one-hot-encoding">
<h3 id="Scikit-learn-implementation-of-one-hot-encoding">Scikit-learn implementation of one-hot encoding<a class="headerlink" href="#Scikit-learn-implementation-of-one-hot-encoding" title="Permalink to this heading">¶</a></h3>
<p>Before implementing one-hot encoding using scikit-learn, we have defined the functions named</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">later_padding</span></code>, which adds horizontal and vertical padding to the given matrix,</p></li>
<li><p>and <code class="docutils literal notranslate"><span class="pre">initial_padding</span></code> which adds zeros to the character list after they are label encoded.</p></li>
</ul>
<p>Both using the <code class="docutils literal notranslate"><span class="pre">numpy.pad</span></code> function as discussed in the theory section.</p>
<p>These functions are later used as a boolean parameter (<code class="docutils literal notranslate"><span class="pre">islaterpadding</span></code> and <code class="docutils literal notranslate"><span class="pre">isinitialpadding</span></code>) in the scikit-learn and keras implementations to choose if later padding or initial padding is required.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to add padding after one-hot encoding</span>
<span class="k">def</span> <span class="nf">later_padding</span><span class="p">(</span><span class="n">ohe_matrix</span><span class="p">,</span> <span class="n">smiles_maxlen</span><span class="p">,</span> <span class="n">unique_char</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Add horizontal and vertical padding</span>
<span class="sd">    to the given matrix using numpy.pad() function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ohe_matrix : ndarray</span>
<span class="sd">        Character array.</span>
<span class="sd">    smiles_max_len : int</span>
<span class="sd">        Maximum length of the SMILES string.</span>
<span class="sd">    unique_char : list</span>
<span class="sd">        List of unique characters in the string data set.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    padded_matrix : numpy.ndarray</span>
<span class="sd">           Padded one-hot encoded matrix of</span>
<span class="sd">           shape (unique char in smiles, max smile_length).</span>
<span class="sd">    """</span>

    <span class="n">padded_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span>
        <span class="n">ohe_matrix</span><span class="p">,</span>
        <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">smiles_maxlen</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">ohe_matrix</span><span class="p">)),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_char</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">ohe_matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">]))),</span>
        <span class="s2">"constant"</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">padded_matrix</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to add padding before one-hot encoding</span>
<span class="c1"># after label (integer) encoding</span>
<span class="k">def</span> <span class="nf">initial_padding</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">max_len</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Add zeroes to the list of characters</span>
<span class="sd">    after integer encoding them</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    smiles : str</span>
<span class="sd">       SMILES string.</span>
<span class="sd">    max_len : int</span>
<span class="sd">       Maximum length of the SMILES string</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    canonical_char_padded : numpy.ndarray</span>
<span class="sd">      Canonical character array padded to max_len.</span>
<span class="sd">    """</span>
    <span class="n">canonical_char</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
    <span class="c1"># Perform padding on the list of characters</span>
    <span class="n">canonical_char_padded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">canonical_char</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_len</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">canonical_char</span><span class="p">)),</span> <span class="s2">"constant"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">canonical_char_padded</span>
</pre></div>
</div>
</div>
<p><strong>One-hot encoding using scikit-learn</strong></p>
<p>Now, we proceed with our second implementation of one-hot encoding from scikit-learn. We can use the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html">OneHotEncoder</a> from the <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> library.</p>
<ul class="simple">
<li><p>The function takes only numerical categorical values, hence any value of type string should be <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html">label_encoded</a> first before one-hot encoding.</p></li>
<li><p>Thus, in the functions below first label (integer) encoded SMILES are produced, then the integer encoded SMILES are transformed to one-hot encoded matrices.</p></li>
<li><p>By default, the OneHotEncoder class returns a more efficient sparse encoding, which we disabled by setting the <code class="docutils literal notranslate"><span class="pre">sparse=False</span></code> argument.</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use Scikit-learn implementation of one-hot encoding</span>
<span class="k">def</span> <span class="nf">sklearn_one_hot_encoded_matrix</span><span class="p">(</span>
    <span class="n">smiles</span><span class="p">,</span> <span class="n">islaterpadding</span><span class="p">,</span> <span class="n">isinitialpadding</span><span class="p">,</span> <span class="n">smiles_maxlen</span><span class="p">,</span> <span class="n">unique_char</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Label and one-hot encodes the SMILES</span>
<span class="sd">    using sklearn LabelEncoder and OneHotEncoder implementation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    smiles : str</span>
<span class="sd">        SMILES string of a compound.</span>
<span class="sd">    islaterpadding : bool</span>
<span class="sd">        Paramater is `True` if `later_padding` is required,</span>
<span class="sd">        `False` otherwise.</span>
<span class="sd">    isinitialpadding : bool</span>
<span class="sd">        Paramater is `True` if `initial_padding` is required,</span>
<span class="sd">        `False` otherwise.</span>
<span class="sd">    smile_maxlen : int</span>
<span class="sd">       Maximum length of the SMILES string</span>
<span class="sd">    unique_char : list</span>
<span class="sd">        List of unique characters in the string data set.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    onehot_encoded : numpy.ndarray</span>
<span class="sd">        One-hot encoded matrix of shape</span>
<span class="sd">        (chars in individual SMILES, length of individual SMILES).</span>
<span class="sd">    """</span>
    <span class="c1"># Integer encoding</span>
    <span class="n">canonical_char</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">smiles</span><span class="p">)</span>
    <span class="n">label_encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
    <span class="c1"># Fit_transform function is used to first fit the data and then transform it</span>
    <span class="n">integer_encoded</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">canonical_char</span><span class="p">)</span>

    <span class="c1"># If initial padding, add zeros to vector (columns in matrix)</span>
    <span class="k">if</span> <span class="n">isinitialpadding</span><span class="p">:</span>
        <span class="n">integer_encoded</span> <span class="o">=</span> <span class="n">initial_padding</span><span class="p">(</span><span class="n">integer_encoded</span><span class="p">,</span> <span class="n">smiles_maxlen</span><span class="p">)</span>

    <span class="c1"># One-hot encoding</span>
    <span class="n">onehot_encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Reshape the integer encoded data</span>
    <span class="n">integer_encoded</span> <span class="o">=</span> <span class="n">integer_encoded</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">integer_encoded</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">onehot_encoded</span> <span class="o">=</span> <span class="n">onehot_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">integer_encoded</span><span class="p">)</span>

    <span class="c1"># If later padding, add zeros to ohe matrix</span>
    <span class="k">if</span> <span class="n">islaterpadding</span><span class="p">:</span>
        <span class="n">onehot_encoded</span> <span class="o">=</span> <span class="n">later_padding</span><span class="p">(</span><span class="n">onehot_encoded</span><span class="p">,</span> <span class="n">smiles_maxlen</span><span class="p">,</span> <span class="n">unique_char</span><span class="p">)</span>

    <span class="n">onehot_encoded</span> <span class="o">=</span> <span class="n">onehot_encoded</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

    <span class="c1"># If initial padding, add zeros to rows</span>
    <span class="k">if</span> <span class="n">isinitialpadding</span><span class="p">:</span>
        <span class="n">row_padding</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_char</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">onehot_encoded</span><span class="p">),</span> <span class="n">smiles_maxlen</span><span class="p">))</span>
        <span class="n">onehot_encoded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">onehot_encoded</span><span class="p">,</span> <span class="n">row_padding</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">onehot_encoded</span>
</pre></div>
</div>
</div>
<section id="Without-padding-(unequal-dimension)">
<h4 id="Without-padding-(unequal-dimension)">Without padding (unequal dimension)<a class="headerlink" href="#Without-padding-(unequal-dimension)" title="Permalink to this heading">¶</a></h4>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">sklearn_one_hot_encoded_matrix</span></code> function defined above to create the one-hot encoded matrix without padding. This will create matrices with unequal dimensions, because it will first label encode all the characters present in the SMILES strings (individually) and then one-hot encode them.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply the function over the processed canonical SMILES strings</span>
<span class="n">df</span><span class="p">[</span><span class="s2">"sklearn_ohe_matrix_no_padding"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">"processed_canonical_smiles"</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="n">sklearn_one_hot_encoded_matrix</span><span class="p">,</span>
    <span class="n">islaterpadding</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">isinitialpadding</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">smiles_maxlen</span><span class="o">=</span><span class="n">smiles_maxlen</span><span class="p">,</span>
    <span class="n">unique_char</span><span class="o">=</span><span class="n">unique_char</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>chembl_id</th>
<th>canonical_smiles</th>
<th>Mol2D</th>
<th>processed_canonical_smiles</th>
<th>unique_char_ohe_matrix</th>
<th>sklearn_ohe_matrix_no_padding</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL207869</td>
<td>Clc1c(OCc2cc(F)ccc2)ccc(Nc2c(C#Cc3ncccn3)cncn2)c1</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f824651b200&gt;</td>
<td>Lc1c(OCc2cc(F)ccc2)ccc(Nc2c(C#Cc3ncccn3)cncn2)c1</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL3940060</td>
<td>ClCC(=O)OCCN1C(=O)Oc2c1cc1c(Nc3cc(Cl)c(F)cc3)n...</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f824651b580&gt;</td>
<td>LCC(=O)OCCN1C(=O)Oc2c1cc1c(Nc3cc(L)c(F)cc3)ncn...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<p><strong>Visualization of one-hot encoded matrix (unequal dimension)</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Choose index of the compound for which the OHE matrix is visualised</span>
<span class="n">index</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">one_hot_matrix_plot</span><span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">"sklearn_ohe_matrix_no_padding"</span><span class="p">],</span>
    <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">"sklearn_ohe_matrix_no_padding"</span><span class="p">],</span>
    <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">"processed_canonical_smiles"</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T021_one_hot_encoding_76_0.png" src="../_images/talktorials_T021_one_hot_encoding_76_0.png"/>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Shape of one-hot matrix :  (15, 43)
Associated canonical SMILES:  N([C@H](C)c1ccccc1)c1ncnc2oc(-c3ccccc3)cc12
</pre></div></div>
</div>
</section>
<section id="With-padding-(equal-dimension)">
<h4 id="With-padding-(equal-dimension)">With padding (equal dimension)<a class="headerlink" href="#With-padding-(equal-dimension)" title="Permalink to this heading">¶</a></h4>
<p>Padding can either be done before or after one-hot encoding is performed on the SMILES strings, meaning after we label encode the SMILES characters. We discuss both scenarios in the next sections.</p>
<section id="Padding-after-one-hot-encoding-is-performed">
<h5 id="Padding-after-one-hot-encoding-is-performed">Padding after one-hot encoding is performed<a class="headerlink" href="#Padding-after-one-hot-encoding-is-performed" title="Permalink to this heading">¶</a></h5>
<p>We simply pass <strong>True</strong> to the <code class="docutils literal notranslate"><span class="pre">islaterpadding</span></code> boolean parameter to the <code class="docutils literal notranslate"><span class="pre">sklearn_one_hot_encoded_matrix</span></code> function as shown below to pad the matrix after one-hot encoding is performed,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply the function over the processed canonical SMILES strings</span>
<span class="n">df</span><span class="p">[</span><span class="s2">"sklearn_ohe_matrix_later_padding"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">"processed_canonical_smiles"</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="n">sklearn_one_hot_encoded_matrix</span><span class="p">,</span>
    <span class="n">islaterpadding</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">isinitialpadding</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">smiles_maxlen</span><span class="o">=</span><span class="n">smiles_maxlen</span><span class="p">,</span>
    <span class="n">unique_char</span><span class="o">=</span><span class="n">unique_char</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>chembl_id</th>
<th>canonical_smiles</th>
<th>Mol2D</th>
<th>processed_canonical_smiles</th>
<th>unique_char_ohe_matrix</th>
<th>sklearn_ohe_matrix_no_padding</th>
<th>sklearn_ohe_matrix_later_padding</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL207869</td>
<td>Clc1c(OCc2cc(F)ccc2)ccc(Nc2c(C#Cc3ncccn3)cncn2)c1</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f824651b200&gt;</td>
<td>Lc1c(OCc2cc(F)ccc2)ccc(Nc2c(C#Cc3ncccn3)cncn2)c1</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL3940060</td>
<td>ClCC(=O)OCCN1C(=O)Oc2c1cc1c(Nc3cc(Cl)c(F)cc3)n...</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f824651b580&gt;</td>
<td>LCC(=O)OCCN1C(=O)Oc2c1cc1c(Nc3cc(L)c(F)cc3)ncn...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<p><strong>Visualization of one-hot encoded matrix (equal dimension)</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Choose index of the compound for which the OHE matrix is visualised</span>
<span class="n">index</span> <span class="o">=</span> <span class="mi">2705</span>
<span class="n">one_hot_matrix_plot</span><span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">"sklearn_ohe_matrix_later_padding"</span><span class="p">],</span>
    <span class="n">unique_char</span><span class="p">,</span>
    <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">"processed_canonical_smiles"</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T021_one_hot_encoding_81_0.png" src="../_images/talktorials_T021_one_hot_encoding_81_0.png"/>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Shape of one-hot matrix :  (36, 267)
Associated canonical SMILES:  O(C)c1c(C(=Cc2c3c(N)nc(N)nc3oc2)CCCC)cccc1
</pre></div></div>
</div>
</section>
<section id="Padding-before-one-hot-encoding-is-performed">
<h5 id="Padding-before-one-hot-encoding-is-performed">Padding before one-hot encoding is performed<a class="headerlink" href="#Padding-before-one-hot-encoding-is-performed" title="Permalink to this heading">¶</a></h5>
<p>In this case, padding is performed before OHE - but after integer encoding - the list of SMILES characters by passing <strong>True</strong> to the <code class="docutils literal notranslate"><span class="pre">initial_padding</span></code> boolean parameter to the <code class="docutils literal notranslate"><span class="pre">sklearn_one_hot_encoded_matrix</span></code> function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply the function over the processed canonical SMILES strings</span>
<span class="n">df</span><span class="p">[</span><span class="s2">"sklearn_ohe_matrix_initial_padding"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">"processed_canonical_smiles"</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="n">sklearn_one_hot_encoded_matrix</span><span class="p">,</span>
    <span class="n">islaterpadding</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">isinitialpadding</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">smiles_maxlen</span><span class="o">=</span><span class="n">smiles_maxlen</span><span class="p">,</span>
    <span class="n">unique_char</span><span class="o">=</span><span class="n">unique_char</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>chembl_id</th>
<th>canonical_smiles</th>
<th>Mol2D</th>
<th>processed_canonical_smiles</th>
<th>unique_char_ohe_matrix</th>
<th>sklearn_ohe_matrix_no_padding</th>
<th>sklearn_ohe_matrix_later_padding</th>
<th>sklearn_ohe_matrix_initial_padding</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL207869</td>
<td>Clc1c(OCc2cc(F)ccc2)ccc(Nc2c(C#Cc3ncccn3)cncn2)c1</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f824651b200&gt;</td>
<td>Lc1c(OCc2cc(F)ccc2)ccc(Nc2c(C#Cc3ncccn3)cncn2)c1</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL3940060</td>
<td>ClCC(=O)OCCN1C(=O)Oc2c1cc1c(Nc3cc(Cl)c(F)cc3)n...</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f824651b580&gt;</td>
<td>LCC(=O)OCCN1C(=O)Oc2c1cc1c(Nc3cc(L)c(F)cc3)ncn...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<p><strong>Visualization of one-hot encoded matrix (equal dimension)</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Choose index of the compound for which the OHE matrix is visualised</span>
<span class="n">index</span> <span class="o">=</span> <span class="mi">2705</span>
<span class="n">one_hot_matrix_plot</span><span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">"sklearn_ohe_matrix_later_padding"</span><span class="p">],</span>
    <span class="n">unique_char</span><span class="p">,</span>
    <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">"processed_canonical_smiles"</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T021_one_hot_encoding_85_0.png" src="../_images/talktorials_T021_one_hot_encoding_85_0.png"/>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Shape of one-hot matrix :  (36, 267)
Associated canonical SMILES:  O(C)c1c(C(=Cc2c3c(N)nc(N)nc3oc2)CCCC)cccc1
</pre></div></div>
</div>
</section>
</section>
</section>
<section id="Keras-implementation-of-one-hot-encoding">
<h3 id="Keras-implementation-of-one-hot-encoding">Keras implementation of one-hot encoding<a class="headerlink" href="#Keras-implementation-of-one-hot-encoding" title="Permalink to this heading">¶</a></h3>
<p>Keras is also a very powerful and intensively used library, especially employed in deep learning tasks. There may be a case where we have sequences or strings that are already integer encoded, then we can use the function called <a class="reference external" href="https://keras.io/api/utils/">to_categorical()</a>, provided by the keras library, to one-hot encode integer data directly, otherwise we can use <a class="reference external" href="https://keras.io/api/preprocessing/text/">Tokenizer</a> to first integer encode the string data and then use the
<code class="docutils literal notranslate"><span class="pre">to_categorical</span></code> function to one-hot encode the data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use keras implementation of one-hot encoding</span>
<span class="k">def</span> <span class="nf">keras_one_hot_encoded_matrix</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">islaterpadding</span><span class="p">,</span> <span class="n">smiles_maxlen</span><span class="p">,</span> <span class="n">unique_char</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    One-hot encodes the SMILES using keras</span>
<span class="sd">    implementation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    canonical_char : array</span>
<span class="sd">        Canonical character array.</span>
<span class="sd">    islaterpadding : bool</span>
<span class="sd">        The paramater is `True` if later_padding is required,</span>
<span class="sd">        `False` otherwise.</span>
<span class="sd">    smiles_maxlen : int</span>
<span class="sd">        Maximum length of the SMILES string.</span>
<span class="sd">    unique_char : list</span>
<span class="sd">        List of unique characters in the string data set.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    encoded : numpy.ndarray</span>
<span class="sd">        One-hot encoded matrix of shape</span>
<span class="sd">        (chars in SMILES, length of SMILES).</span>
<span class="sd">    """</span>

    <span class="c1"># Integer encoding using Tokenizer</span>
    <span class="n">input_smiles</span> <span class="o">=</span> <span class="n">smiles</span>
    <span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">(</span><span class="n">char_level</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tokenizer</span><span class="o">.</span><span class="n">fit_on_texts</span><span class="p">([</span><span class="n">input_smiles</span><span class="p">])</span>
    <span class="n">integer_encoded</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">texts_to_sequences</span><span class="p">([</span><span class="n">input_smiles</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># One-hot encoding using to_categorical function</span>
    <span class="n">encoded</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">integer_encoded</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">islaterpadding</span><span class="p">:</span>
        <span class="n">encoded</span> <span class="o">=</span> <span class="n">later_padding</span><span class="p">(</span><span class="n">encoded</span><span class="p">,</span> <span class="n">smiles_maxlen</span><span class="p">,</span> <span class="n">unique_char</span><span class="p">)</span>
    <span class="n">encoded</span> <span class="o">=</span> <span class="n">encoded</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">encoded</span>
</pre></div>
</div>
</div>
<p>Next, we implement two scenarios:</p>
<ul class="simple">
<li><p>OHE without padding, which will result in unequal dimensions of the produced one-hot encoded matrix and</p></li>
<li><p>OHE with later padding by passing <code class="docutils literal notranslate"><span class="pre">True</span></code> to the boolean parameter <code class="docutils literal notranslate"><span class="pre">islaterpadding</span></code> in the <code class="docutils literal notranslate"><span class="pre">keras_one_hot_encoded_matrix</span></code> function.</p></li>
</ul>
<section id="id1">
<h4 id="id1">Without padding (unequal dimension)<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply the function over the processed canonical SMILES strings</span>
<span class="n">df</span><span class="p">[</span><span class="s2">"keras_ohe_matrix_without_padding"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">"processed_canonical_smiles"</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="n">keras_one_hot_encoded_matrix</span><span class="p">,</span>
    <span class="n">smiles_maxlen</span><span class="o">=</span><span class="n">smiles_maxlen</span><span class="p">,</span>
    <span class="n">unique_char</span><span class="o">=</span><span class="n">unique_char</span><span class="p">,</span>
    <span class="n">islaterpadding</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>chembl_id</th>
<th>canonical_smiles</th>
<th>Mol2D</th>
<th>processed_canonical_smiles</th>
<th>unique_char_ohe_matrix</th>
<th>sklearn_ohe_matrix_no_padding</th>
<th>sklearn_ohe_matrix_later_padding</th>
<th>sklearn_ohe_matrix_initial_padding</th>
<th>keras_ohe_matrix_without_padding</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL207869</td>
<td>Clc1c(OCc2cc(F)ccc2)ccc(Nc2c(C#Cc3ncccn3)cncn2)c1</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f824651b200&gt;</td>
<td>Lc1c(OCc2cc(F)ccc2)ccc(Nc2c(C#Cc3ncccn3)cncn2)c1</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL3940060</td>
<td>ClCC(=O)OCCN1C(=O)Oc2c1cc1c(Nc3cc(Cl)c(F)cc3)n...</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f824651b580&gt;</td>
<td>LCC(=O)OCCN1C(=O)Oc2c1cc1c(Nc3cc(L)c(F)cc3)ncn...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<p><strong>Visualization of one-hot encoded matrix (unequal dimension)</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Choose index of the compound for which the OHE matrix is visualised</span>
<span class="n">index</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">one_hot_matrix_plot</span><span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">"keras_ohe_matrix_without_padding"</span><span class="p">],</span>
    <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">"keras_ohe_matrix_without_padding"</span><span class="p">],</span>
    <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">"processed_canonical_smiles"</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T021_one_hot_encoding_93_0.png" src="../_images/talktorials_T021_one_hot_encoding_93_0.png"/>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Shape of one-hot matrix :  (14, 43)
Associated canonical SMILES:  N([C@H](C)c1ccccc1)c1ncnc2oc(-c3ccccc3)cc12
</pre></div></div>
</div>
</section>
<section id="id2">
<h4 id="id2">With padding (equal dimension)<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply the function over the Processed_canonical_smiles strings</span>
<span class="n">df</span><span class="p">[</span><span class="s2">"keras_ohe_matrix_padding"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">"processed_canonical_smiles"</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="n">keras_one_hot_encoded_matrix</span><span class="p">,</span>
    <span class="n">smiles_maxlen</span><span class="o">=</span><span class="n">smiles_maxlen</span><span class="p">,</span>
    <span class="n">unique_char</span><span class="o">=</span><span class="n">unique_char</span><span class="p">,</span>
    <span class="n">islaterpadding</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>chembl_id</th>
<th>canonical_smiles</th>
<th>Mol2D</th>
<th>processed_canonical_smiles</th>
<th>unique_char_ohe_matrix</th>
<th>sklearn_ohe_matrix_no_padding</th>
<th>sklearn_ohe_matrix_later_padding</th>
<th>sklearn_ohe_matrix_initial_padding</th>
<th>keras_ohe_matrix_without_padding</th>
<th>keras_ohe_matrix_padding</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL207869</td>
<td>Clc1c(OCc2cc(F)ccc2)ccc(Nc2c(C#Cc3ncccn3)cncn2)c1</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f824651b200&gt;</td>
<td>Lc1c(OCc2cc(F)ccc2)ccc(Nc2c(C#Cc3ncccn3)cncn2)c1</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL3940060</td>
<td>ClCC(=O)OCCN1C(=O)Oc2c1cc1c(Nc3cc(Cl)c(F)cc3)n...</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f824651b580&gt;</td>
<td>LCC(=O)OCCN1C(=O)Oc2c1cc1c(Nc3cc(L)c(F)cc3)ncn...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
<td>[[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,...</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<p><strong>Visualization of one-hot encoded matrix (unequal dimension)</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Choose index of the compound for which the OHE matrix is visualised</span>
<span class="n">index</span> <span class="o">=</span> <span class="mi">2705</span>
<span class="n">one_hot_matrix_plot</span><span class="p">(</span>
    <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">"keras_ohe_matrix_padding"</span><span class="p">],</span>
    <span class="n">unique_char</span><span class="p">,</span>
    <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s2">"processed_canonical_smiles"</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T021_one_hot_encoding_97_0.png" src="../_images/talktorials_T021_one_hot_encoding_97_0.png"/>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Shape of one-hot matrix :  (36, 267)
Associated canonical SMILES:  O(C)c1c(C(=Cc2c3c(N)nc(N)nc3oc2)CCCC)cccc1
</pre></div></div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {}, "version_major": 2, "version_minor": 0}
</script></section>
</section>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="T020_md_analysis.html" title="T020 · Analyzing molecular dynamics simulations"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> T020 · Analyzing molecular dynamics simulations </span>
              </div>
            </a>
          
          
            <a href="T022_ligand_based_screening_neural_network.html" title="T022 · Ligand-based screening: neural networks"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> T022 · Ligand-based screening: neural networks </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2018-2023, Volkamer Lab. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.1.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>