<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="T001 · Compound data acquisition (ChEMBL)" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://projects.volkamerlab.org/teachopencadd/talktorials/T001_query_chembl.html" />
<meta property="og:site_name" content="TeachOpenCADD" />
<meta property="og:description" content="Note: This talktorial is a part of TeachOpenCADD, a platform that aims to teach domain-specific skills and to provide pipeline templates as starting points for research projects. Authors: Svetlana Leng, CADD seminar 2017, Volkamer lab, Charité/FU Berlin, Paula Junge, CADD seminar 2018, Volkamer l..." />
<meta property="og:image" content="https://raw.githubusercontent.com/volkamerlab/teachopencadd/master/docs/_static/images/TeachOpenCADD_topics.png" />
<meta property="og:image:alt" content="TeachOpenCADD" />
<meta name="description" content="Note: This talktorial is a part of TeachOpenCADD, a platform that aims to teach domain-specific skills and to provide pipeline templates as starting points for research projects. Authors: Svetlana Leng, CADD seminar 2017, Volkamer lab, Charité/FU Berlin, Paula Junge, CADD seminar 2018, Volkamer l..." />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#2196f3">
  <script src="../_static/javascripts/modernizr.js"></script>
  
    <script async src="../_static/cookieconsent.min.js"></script>
    <script>
        window.addEventListener("load", function(){
        window.cookieconsent.initialise({
            "palette": {
            "popup": {
                "background": "#f0f0f0",
                "text": "#999"
            },
            "button": {
                "text": "#fff",
                "background": "#009688"
            }
            },
            "theme": "classic"
        })});
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q6ZE82CNZB"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-Q6ZE82CNZB');
    </script>
  
    <link rel="apple-touch-icon" href="../_static/images/apple-icon-152x152.png"/>
  
  
    <title>T001 · Compound data acquisition (ChEMBL) &#8212; TeachOpenCADD 0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="T002 · Molecular filtering: ADME and lead-likeness criteria" href="T002_compound_adme.html" />
    <link rel="prev" title="Complete list of talktorials" href="../all_talktorials.html" />
  
    <link rel="apple-touch-icon" href="../_static/images/apple-icon-152x152.png"/>
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=teal data-md-color-accent=cyan>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#talktorials/T001_query_chembl" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="TeachOpenCADD 0 documentation"
           class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">TeachOpenCADD</span>
          <span class="md-header-nav__topic"> T001 · Compound data acquisition (ChEMBL) </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/volkamerlab/teachopencadd/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    TeachOpenCADD
  </div>
</a>
          </div>
        </div>
      
      
    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../talktorials.html" class="md-tabs__link">Our talktorials</a></li>
            
            <li class="md-tabs__item"><a href="../installing.html" class="md-tabs__link">Run locally</a></li>
            
            <li class="md-tabs__item"><a href="../contribute.html" class="md-tabs__link">Development</a></li>
            
            <li class="md-tabs__item"><a href="../contact.html" class="md-tabs__link">Contact</a></li>
            
            <li class="md-tabs__item"><a href="../citation.html" class="md-tabs__link">Citation</a></li>
          <li class="md-tabs__item"><a href="../all_talktorials.html" class="md-tabs__link">Complete list of talktorials</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="TeachOpenCADD 0 documentation" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    <a href="../index.html"
       title="TeachOpenCADD 0 documentation">TeachOpenCADD</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/volkamerlab/teachopencadd/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    TeachOpenCADD
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Our talktorials</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../all_talktorials.html" class="md-nav__link">Complete list of talktorials</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html" class="md-nav__link">Talktorials by collection</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html#edition-2019-jcim" class="md-nav__link">Edition 2019 - JCIM</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html#edition-2021" class="md-nav__link">Edition 2021</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html#ligand-based-cheminformatics" class="md-nav__link">Ligand-based cheminformatics</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html#structural-biology" class="md-nav__link">Structural biology</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html#online-apis-servers" class="md-nav__link">Online APIs/servers</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../talktorials.html#kinase-similarity" class="md-nav__link">Kinase similarity</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Run locally</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installing.html" class="md-nav__link">Installing</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Development</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../contribute.html" class="md-nav__link">For contributors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../api.html" class="md-nav__link">API Documentation</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">About TeachOpenCADD</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../contact.html" class="md-nav__link">Contact</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../acknowledgments.html" class="md-nav__link">Acknowledgments</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../citation.html" class="md-nav__link">Citation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../license.html" class="md-nav__link">License</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../funding.html" class="md-nav__link">Funding</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">External resources</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../external_dependencies.html" class="md-nav__link">Packages and webservers used in TeachOpenCADD</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../external_tutorials_collections.html" class="md-nav__link">External tutorials and collections</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#talktorials-t001-query-chembl--page-root" class="md-nav__link">T001 · Compound data acquisition (ChEMBL)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Aim-of-this-talktorial" class="md-nav__link">Aim of this talktorial</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Contents-in-Theory" class="md-nav__link">Contents in <em>Theory</em></a>
        </li>
        <li class="md-nav__item"><a href="#Contents-in-Practical" class="md-nav__link">Contents in <em>Practical</em></a>
        </li>
        <li class="md-nav__item"><a href="#References" class="md-nav__link">References</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Theory" class="md-nav__link">Theory</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#ChEMBL-database" class="md-nav__link">ChEMBL database</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#ChEMBL-web-services" class="md-nav__link">ChEMBL web services</a>
        </li>
        <li class="md-nav__item"><a href="#ChEMBL-webresource-client" class="md-nav__link">ChEMBL webresource client</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Compound-activity-measures" class="md-nav__link">Compound activity measures</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#IC50-measure" class="md-nav__link">IC50 measure</a>
        </li>
        <li class="md-nav__item"><a href="#pIC50-value" class="md-nav__link">pIC50 value</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Practical" class="md-nav__link">Practical</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Connect-to-ChEMBL-database" class="md-nav__link">Connect to ChEMBL database</a>
        </li>
        <li class="md-nav__item"><a href="#Get-target-data-(EGFR-kinase)" class="md-nav__link">Get target data (EGFR kinase)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Fetch-target-data-from-ChEMBL" class="md-nav__link">Fetch target data from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Download-target-data-from-ChEMBL" class="md-nav__link">Download target data from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Select-target-(target-ChEMBL-ID)" class="md-nav__link">Select target (target ChEMBL ID)</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Get-bioactivity-data" class="md-nav__link">Get bioactivity data</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Fetch-bioactivity-data-for-the-target-from-ChEMBL" class="md-nav__link">Fetch bioactivity data for the target from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Download-bioactivity-data-from-ChEMBL" class="md-nav__link">Download bioactivity data from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Preprocess-and-filter-bioactivity-data" class="md-nav__link">Preprocess and filter bioactivity data</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Get-compound-data" class="md-nav__link">Get compound data</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Fetch-compound-data-from-ChEMBL" class="md-nav__link">Fetch compound data from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Download-compound-data-from-ChEMBL" class="md-nav__link">Download compound data from ChEMBL</a>
        </li>
        <li class="md-nav__item"><a href="#Preprocess-and-filter-compound-data" class="md-nav__link">Preprocess and filter compound data</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Output-(bioactivity-compound)-data" class="md-nav__link">Output (bioactivity-compound) data</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Merge-both-datasets" class="md-nav__link">Merge both datasets</a>
        </li>
        <li class="md-nav__item"><a href="#Add-pIC50-values" class="md-nav__link">Add pIC50 values</a>
        </li>
        <li class="md-nav__item"><a href="#Draw-compound-data" class="md-nav__link">Draw compound data</a>
        </li>
        <li class="md-nav__item"><a href="#Freeze-output-data-to-ChEMBL-27" class="md-nav__link">Freeze output data to ChEMBL 27</a>
        </li>
        <li class="md-nav__item"><a href="#Write-output-data-to-file" class="md-nav__link">Write output data to file</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Discussion" class="md-nav__link">Discussion</a>
        </li>
        <li class="md-nav__item"><a href="#Quiz" class="md-nav__link">Quiz</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/talktorials/T001_query_chembl.nblink.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="T001-·-Compound-data-acquisition-(ChEMBL)">
<h1 id="talktorials-t001-query-chembl--page-root">T001 · Compound data acquisition (ChEMBL)<a class="headerlink" href="#talktorials-t001-query-chembl--page-root" title="Permalink to this heading">¶</a></h1>
<p><strong>Note:</strong> This talktorial is a part of TeachOpenCADD, a platform that aims to teach domain-specific skills and to provide pipeline templates as starting points for research projects.</p>
<p>Authors:</p>
<ul class="simple">
<li><p>Svetlana Leng, CADD seminar 2017, Volkamer lab, Charité/FU Berlin</p></li>
<li><p>Paula Junge, CADD seminar 2018, Volkamer lab, Charité/FU Berlin</p></li>
<li><p>Dominique Sydow, 2019-2020, <a class="reference external" href="https://volkamerlab.org/">Volkamer lab, Charité</a></p></li>
<li><p>Andrea Volkamer, 2020, <a class="reference external" href="https://volkamerlab.org/">Volkamer lab, Charité</a></p></li>
<li><p>Yonghui Chen, 2020, <a class="reference external" href="https://volkamerlab.org/">Volkamer lab, Charité</a></p></li>
</ul>
<p><strong>Talktorial T001</strong>: This talktorial is part of the TeachOpenCADD pipeline described in the <a class="reference external" href="https://jcheminf.biomedcentral.com/articles/10.1186/s13321-019-0351-x">first TeachOpenCADD paper</a>, comprising of talktorials T001-T010.</p>
<section id="Aim-of-this-talktorial">
<h2 id="Aim-of-this-talktorial">Aim of this talktorial<a class="headerlink" href="#Aim-of-this-talktorial" title="Permalink to this heading">¶</a></h2>
<p>In this notebook, we will learn more about the ChEMBL database and how to extract data from ChEMBL, i.e. (compound, activity data) pairs for a target of interest. These data sets can be used for many cheminformatics tasks, such as similarity search, clustering or machine learning.</p>
<p>Our work here will include finding compounds which were tested against a certain target and filtering available bioactivity data.</p>
<section id="Contents-in-Theory">
<h3 id="Contents-in-Theory">Contents in <em>Theory</em><a class="headerlink" href="#Contents-in-Theory" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>ChEMBL database</p>
<ul>
<li><p>ChEMBL web services</p></li>
<li><p>ChEMBL webresource client</p></li>
</ul>
</li>
<li><p>Compound activity measures</p>
<ul>
<li><p>IC50 measure</p></li>
<li><p>pIC50 value</p></li>
</ul>
</li>
</ul>
</section>
<section id="Contents-in-Practical">
<h3 id="Contents-in-Practical">Contents in <em>Practical</em><a class="headerlink" href="#Contents-in-Practical" title="Permalink to this heading">¶</a></h3>
<p><strong>Goal: Get a list of compounds with bioactivity data for a given target</strong></p>
<ul class="simple">
<li><p>Connect to ChEMBL database</p></li>
<li><p>Get target data (example: EGFR kinase)</p>
<ul>
<li><p>Fetch and download target data</p></li>
<li><p>Select target ChEMBL ID</p></li>
</ul>
</li>
<li><p>Get bioactivity data</p>
<ul>
<li><p>Fetch and download bioactivity data for target</p></li>
<li><p>Preprocess and filter bioactivity data</p></li>
</ul>
</li>
<li><p>Get compound data</p>
<ul>
<li><p>Fetch and download compound data</p></li>
<li><p>Preprocess and filter compound data</p></li>
</ul>
</li>
<li><p>Output bioactivity-compound data</p>
<ul>
<li><p>Merge bioactivity and compound data, and add pIC50 values</p></li>
<li><p>Draw molecules with highest pIC50</p></li>
<li><p>Freeze bioactivity data to ChEMBL 27</p></li>
<li><p>Write output file</p></li>
</ul>
</li>
</ul>
</section>
<section id="References">
<h3 id="References">References<a class="headerlink" href="#References" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>ChEMBL bioactivity database: <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5210557/">Gaulton et al., Nucleic Acids Res. (2017), 45(Database issue), D945–D954</a></p></li>
<li><p>ChEMBL web services: <a class="reference external" href="https://academic.oup.com/nar/article/43/W1/W612/2467881">Davies et al., Nucleic Acids Res. (2015), 43, 612-620</a></p></li>
<li><p><a class="reference external" href="https://www.ebi.ac.uk/chembl/">ChEMBL web-interface</a></p></li>
<li><p>GitHub <a class="reference external" href="https://github.com/chembl/chembl_webresource_client">ChEMBL webrescource client</a></p></li>
<li><p>The EBI RDF platform: <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/24413672">Jupp et al., Bioinformatics (2014), 30(9), 1338-9</a></p></li>
<li><p>Info on half maximal inhibitory concentration: <a class="reference external" href="https://en.wikipedia.org/wiki/IC50">(p)IC50</a></p></li>
<li><p><a class="reference external" href="https://www.uniprot.org/">UniProt website</a></p></li>
</ul>
</section>
</section>
<section id="Theory">
<h2 id="Theory">Theory<a class="headerlink" href="#Theory" title="Permalink to this heading">¶</a></h2>
<section id="ChEMBL-database">
<h3 id="ChEMBL-database">ChEMBL database<a class="headerlink" href="#ChEMBL-database" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><p>“ChEMBL is a manually curated database of bioactive molecules with drug-like properties. It brings together chemical, bioactivity and genomic data to aid the translation of genomic information into effective new drugs.” (<a class="reference external" href="https://www.ebi.ac.uk/chembl/">ChEMBL website</a>)</p>
</div></blockquote>
<ul class="simple">
<li><p>Open large-scale bioactivity database</p></li>
<li><p><strong>Current data content (as of 09.2020, ChEMBL 27):</strong></p>
<ul>
<li><p>&gt;1.9 million distinct compounds</p></li>
<li><p>&gt;16 million activity values</p></li>
<li><p>Assays are mapped to ~13,000 targets</p></li>
</ul>
</li>
<li><p><strong>Data sources</strong> include scientific literature, PubChem bioassays, Drugs for Neglected Diseases Initiative (DNDi), BindingDB database, …</p></li>
<li><p>ChEMBL data can be accessed via a <a class="reference external" href="https://www.ebi.ac.uk/chembl/">web-interface</a>, the <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/24413672">EBI-RDF platform</a> and the <a class="reference external" href="https://github.com/chembl/chembl_webresource_client">ChEMBL webrescource client</a></p></li>
</ul>
<section id="ChEMBL-web-services">
<h4 id="ChEMBL-web-services">ChEMBL web services<a class="headerlink" href="#ChEMBL-web-services" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>RESTful web service</p></li>
<li><p>ChEMBL web service version 2.x resource schema:</p></li>
</ul>
<img alt="ChEMBL web service schema" src="../_images/chembl_webservices_schema_diagram.jpg"/>
<p><em>Figure 1:</em> “<a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4489243/figure/F2/">ChEMBL web service schema diagram</a>. The oval shapes represent ChEMBL web service resources and the line between two resources indicates that they share a common attribute. The arrow direction shows where the primary information about a resource type can be found. A dashed line indicates the relationship between two resources behaves differently. For example, the <code class="docutils literal notranslate"><span class="pre">Image</span></code> resource provides a graphical based
representation of a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code>.” Figure and description taken from: <a class="reference external" href="https://academic.oup.com/nar/article/43/W1/W612/2467881">Nucleic Acids Res. (2015), 43, 612-620</a>.</p>
</section>
<section id="ChEMBL-webresource-client">
<h4 id="ChEMBL-webresource-client">ChEMBL webresource client<a class="headerlink" href="#ChEMBL-webresource-client" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>Python client library for accessing ChEMBL data</p></li>
<li><p>Handles interaction with the HTTPS protocol</p></li>
<li><p>Lazy evaluation of results -&gt; reduced number of network requests</p></li>
</ul>
</section>
</section>
<section id="Compound-activity-measures">
<h3 id="Compound-activity-measures">Compound activity measures<a class="headerlink" href="#Compound-activity-measures" title="Permalink to this heading">¶</a></h3>
<section id="IC50-measure">
<h4 id="IC50-measure">IC50 measure<a class="headerlink" href="#IC50-measure" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/IC50">Half maximal inhibitory concentration</a></p></li>
<li><p>Indicates how much of a particular drug or other substance is needed to inhibit a given biological process by half</p></li>
</ul>
<img alt="Wiki_Example_IC50_curve_demonstrating_visually_how_IC50_is_derived" src="../_images/Wiki_Example_IC50_curve_demonstrating_visually_how_IC50_is_derived.png"/>
<p><em>Figure 2:</em> Visual demonstration of how to derive an IC50 value: (i) Arrange inhibition data on y-axis and log(concentration) on x-axis. (ii) Identify maximum and minimum inhibition. (iii) The IC50 is the concentration at which the curve passes through the 50% inhibition level. Figure <a class="reference external" href="https://en.wikipedia.org/wiki/IC50#/media/File:Example_IC50_curve_demonstrating_visually_how_IC50_is_derived.png">“Example IC50 curve demonstrating visually how IC50 is derived”</a> by JesseAlanGordon is licensed
under <a class="reference external" href="https://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0</a>.</p>
</section>
<section id="pIC50-value">
<h4 id="pIC50-value">pIC50 value<a class="headerlink" href="#pIC50-value" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>To facilitate the comparison of IC50 values, which have a large value range and are given in different units (M, nM, …), often pIC50 values are used</p></li>
<li><p>The pIC50 is the negative log of the IC50 value when converted to molar units: $ pIC_{50} = -log_{10}(IC_{50}) $, where $ IC_{50}$ is specified in units of M</p></li>
<li><p>Higher pIC50 values indicate exponentially greater potency of the drug</p></li>
<li><p>Note that the conversion can be adapted to the respective IC50 unit, e.g. for nM: $pIC_{50} = -log_{10}(IC_{50}*10^{-9})= 9-log_{10}(IC_{50}) $</p></li>
</ul>
<p>Other activity measures:</p>
<p>Besides, IC50 and pIC50, other bioactivity measures are used, such as the equilibrium constant <a class="reference external" href="https://en.wikipedia.org/wiki/Equilibrium_constant">KI</a> and the half maximal effective concentration <a class="reference external" href="https://en.wikipedia.org/wiki/EC50">EC50</a>.</p>
</section>
</section>
</section>
<section id="Practical">
<h2 id="Practical">Practical<a class="headerlink" href="#Practical" title="Permalink to this heading">¶</a></h2>
<p>In the following, we want to download all molecules that have been tested against our target of interest, the <strong>epidermal growth factor receptor</strong> (<a class="reference external" href="https://www.uniprot.org/uniprot/P00533">EGFR</a>) kinase.</p>
<section id="Connect-to-ChEMBL-database">
<h3 id="Connect-to-ChEMBL-database">Connect to ChEMBL database<a class="headerlink" href="#Connect-to-ChEMBL-database" title="Permalink to this heading">¶</a></h3>
<p>First, the ChEMBL webresource client as well as other Python libraries are imported.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">zipfile</span> <span class="kn">import</span> <span class="n">ZipFile</span>
<span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">PandasTools</span>
<span class="kn">from</span> <span class="nn">chembl_webresource_client.new_client</span> <span class="kn">import</span> <span class="n">new_client</span>
<span class="kn">from</span> <span class="nn">tqdm.auto</span> <span class="kn">import</span> <span class="n">tqdm</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HERE</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">_dh</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">DATA</span> <span class="o">=</span> <span class="n">HERE</span> <span class="o">/</span> <span class="s2">"data"</span>
</pre></div>
</div>
</div>
<p>Next, we create resource objects for API access.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">targets_api</span> <span class="o">=</span> <span class="n">new_client</span><span class="o">.</span><span class="n">target</span>
<span class="n">compounds_api</span> <span class="o">=</span> <span class="n">new_client</span><span class="o">.</span><span class="n">molecule</span>
<span class="n">bioactivities_api</span> <span class="o">=</span> <span class="n">new_client</span><span class="o">.</span><span class="n">activity</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">targets_api</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
chembl_webresource_client.query_set.QuerySet
</pre></div></div>
</div>
</section>
<section id="Get-target-data-(EGFR-kinase)">
<h3 id="Get-target-data-(EGFR-kinase)">Get target data (EGFR kinase)<a class="headerlink" href="#Get-target-data-(EGFR-kinase)" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Get UniProt ID of the target of interest (EGFR kinase: <a class="reference external" href="http://www.uniprot.org/uniprot/P00533">P00533</a>) from <a class="reference external" href="https://www.uniprot.org/">UniProt website</a></p></li>
<li><p>Use UniProt ID to get target information</p></li>
</ul>
<p>Select a different UniProt ID, if you are interested in another target.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uniprot_id</span> <span class="o">=</span> <span class="s2">"P00533"</span>
</pre></div>
</div>
</div>
<section id="Fetch-target-data-from-ChEMBL">
<h4 id="Fetch-target-data-from-ChEMBL">Fetch target data from ChEMBL<a class="headerlink" href="#Fetch-target-data-from-ChEMBL" title="Permalink to this heading">¶</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get target information from ChEMBL but restrict it to specified values only</span>
<span class="n">targets</span> <span class="o">=</span> <span class="n">targets_api</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target_components__accession</span><span class="o">=</span><span class="n">uniprot_id</span><span class="p">)</span><span class="o">.</span><span class="n">only</span><span class="p">(</span>
    <span class="s2">"target_chembl_id"</span><span class="p">,</span> <span class="s2">"organism"</span><span class="p">,</span> <span class="s2">"pref_name"</span><span class="p">,</span> <span class="s2">"target_type"</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'The type of the targets is "</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span><span class="si">}</span><span class="s1">"'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The type of the targets is "&lt;class 'chembl_webresource_client.query_set.QuerySet'&gt;"
</pre></div></div>
</div>
</section>
<section id="Download-target-data-from-ChEMBL">
<h4 id="Download-target-data-from-ChEMBL">Download target data from ChEMBL<a class="headerlink" href="#Download-target-data-from-ChEMBL" title="Permalink to this heading">¶</a></h4>
<p>The results of the query are stored in <code class="docutils literal notranslate"><span class="pre">targets</span></code>, a <code class="docutils literal notranslate"><span class="pre">QuerySet</span></code>, i.e. the results are not fetched from ChEMBL until we ask for it (here using <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame.from_records</span></code>).</p>
<p>More information about the <code class="docutils literal notranslate"><span class="pre">QuerySet</span></code> datatype:</p>
<blockquote>
<div><p>QuerySets are lazy – the act of creating a QuerySet does not involve any database activity. You can stack filters together all day long, and Django will actually not run the query until the QuerySet is evaluated. (<a class="reference external" href="https://docs.djangoproject.com/en/3.0/topics/db/queries/#querysets-are-lazy">querysets-are-lazy</a>)</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">targets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
<span class="n">targets</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>organism</th>
<th>pref_name</th>
<th>target_chembl_id</th>
<th>target_type</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Homo sapiens</td>
<td>Epidermal growth factor receptor erbB1</td>
<td>CHEMBL203</td>
<td>SINGLE PROTEIN</td>
</tr>
<tr>
<th>1</th>
<td>Homo sapiens</td>
<td>Epidermal growth factor receptor erbB1</td>
<td>CHEMBL203</td>
<td>SINGLE PROTEIN</td>
</tr>
<tr>
<th>2</th>
<td>Homo sapiens</td>
<td>Epidermal growth factor receptor and ErbB2 (HE...</td>
<td>CHEMBL2111431</td>
<td>PROTEIN FAMILY</td>
</tr>
<tr>
<th>3</th>
<td>Homo sapiens</td>
<td>Epidermal growth factor receptor</td>
<td>CHEMBL2363049</td>
<td>PROTEIN FAMILY</td>
</tr>
<tr>
<th>4</th>
<td>Homo sapiens</td>
<td>MER intracellular domain/EGFR extracellular do...</td>
<td>CHEMBL3137284</td>
<td>CHIMERIC PROTEIN</td>
</tr>
<tr>
<th>5</th>
<td>Homo sapiens</td>
<td>Protein cereblon/Epidermal growth factor receptor</td>
<td>CHEMBL4523680</td>
<td>PROTEIN-PROTEIN INTERACTION</td>
</tr>
<tr>
<th>6</th>
<td>Homo sapiens</td>
<td>EGFR/PPP1CA</td>
<td>CHEMBL4523747</td>
<td>PROTEIN-PROTEIN INTERACTION</td>
</tr>
<tr>
<th>7</th>
<td>Homo sapiens</td>
<td>VHL/EGFR</td>
<td>CHEMBL4523998</td>
<td>PROTEIN-PROTEIN INTERACTION</td>
</tr>
<tr>
<th>8</th>
<td>Homo sapiens</td>
<td>Baculoviral IAP repeat-containing protein 2/Ep...</td>
<td>CHEMBL4802031</td>
<td>PROTEIN-PROTEIN INTERACTION</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</section>
<section id="Select-target-(target-ChEMBL-ID)">
<h4 id="Select-target-(target-ChEMBL-ID)">Select target (target ChEMBL ID)<a class="headerlink" href="#Select-target-(target-ChEMBL-ID)" title="Permalink to this heading">¶</a></h4>
<p>After checking the entries, we select the first entry as our target of interest:</p>
<p><code class="docutils literal notranslate"><span class="pre">CHEMBL203</span></code>: It is a single protein and represents the human Epidermal growth factor receptor (EGFR, also named erbB1)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">target</span> <span class="o">=</span> <span class="n">targets</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">target</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
organism                                      Homo sapiens
pref_name           Epidermal growth factor receptor erbB1
target_chembl_id                                 CHEMBL203
target_type                                 SINGLE PROTEIN
Name: 0, dtype: object
</pre></div></div>
</div>
<p>Save selected ChEMBL ID.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chembl_id</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">target_chembl_id</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The target ChEMBL ID is </span><span class="si">{</span><span class="n">chembl_id</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The target ChEMBL ID is CHEMBL203
</pre></div></div>
</div>
</section>
</section>
<section id="Get-bioactivity-data">
<h3 id="Get-bioactivity-data">Get bioactivity data<a class="headerlink" href="#Get-bioactivity-data" title="Permalink to this heading">¶</a></h3>
<p>Now, we want to query bioactivity data for the target of interest.</p>
<section id="Fetch-bioactivity-data-for-the-target-from-ChEMBL">
<h4 id="Fetch-bioactivity-data-for-the-target-from-ChEMBL">Fetch bioactivity data for the target from ChEMBL<a class="headerlink" href="#Fetch-bioactivity-data-for-the-target-from-ChEMBL" title="Permalink to this heading">¶</a></h4>
<p>In this step, we fetch the bioactivity data and filter it to only consider</p>
<ul class="simple">
<li><p>human proteins,</p></li>
<li><p>bioactivity type IC50,</p></li>
<li><p>exact measurements (relation <code class="docutils literal notranslate"><span class="pre">'='</span></code>), and</p></li>
<li><p>binding data (assay type <code class="docutils literal notranslate"><span class="pre">'B'</span></code>).</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bioactivities</span> <span class="o">=</span> <span class="n">bioactivities_api</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">target_chembl_id</span><span class="o">=</span><span class="n">chembl_id</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">"IC50"</span><span class="p">,</span> <span class="n">relation</span><span class="o">=</span><span class="s2">"="</span><span class="p">,</span> <span class="n">assay_type</span><span class="o">=</span><span class="s2">"B"</span>
<span class="p">)</span><span class="o">.</span><span class="n">only</span><span class="p">(</span>
    <span class="s2">"activity_id"</span><span class="p">,</span>
    <span class="s2">"assay_chembl_id"</span><span class="p">,</span>
    <span class="s2">"assay_description"</span><span class="p">,</span>
    <span class="s2">"assay_type"</span><span class="p">,</span>
    <span class="s2">"molecule_chembl_id"</span><span class="p">,</span>
    <span class="s2">"type"</span><span class="p">,</span>
    <span class="s2">"standard_units"</span><span class="p">,</span>
    <span class="s2">"relation"</span><span class="p">,</span>
    <span class="s2">"standard_value"</span><span class="p">,</span>
    <span class="s2">"target_chembl_id"</span><span class="p">,</span>
    <span class="s2">"target_organism"</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Length and type of bioactivities object: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">bioactivities</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">bioactivities</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Length and type of bioactivities object: 9576, &lt;class 'chembl_webresource_client.query_set.QuerySet'&gt;
</pre></div></div>
</div>
<p>Each entry in our bioactivity set holds the following information:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Length and type of first element: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">bioactivities</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">bioactivities</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">bioactivities</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Length and type of first element: 13, &lt;class 'dict'&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{'activity_id': 32260,
 'assay_chembl_id': 'CHEMBL674637',
 'assay_description': 'Inhibitory activity towards tyrosine phosphorylation for the epidermal growth factor-receptor kinase',
 'assay_type': 'B',
 'molecule_chembl_id': 'CHEMBL68920',
 'relation': '=',
 'standard_units': 'nM',
 'standard_value': '41.0',
 'target_chembl_id': 'CHEMBL203',
 'target_organism': 'Homo sapiens',
 'type': 'IC50',
 'units': 'uM',
 'value': '0.041'}
</pre></div></div>
</div>
</section>
<section id="Download-bioactivity-data-from-ChEMBL">
<h4 id="Download-bioactivity-data-from-ChEMBL">Download bioactivity data from ChEMBL<a class="headerlink" href="#Download-bioactivity-data-from-ChEMBL" title="Permalink to this heading">¶</a></h4>
<p>Finally, we download the <code class="docutils literal notranslate"><span class="pre">QuerySet</span></code> in the form of a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<blockquote>
<div><p><strong>Note</strong>: This step should not take more than 2 minutes, if so try to rerun all cells starting from <em>“Fetch bioactivity data for the target from ChEMBL”</em> or read this message below:</p>
</div></blockquote>
<details><summary><p>Load a local version of the data (in case you encounter any problems while fetching the data)</p>
</summary><p>If you experience difficulties to query the ChEMBL database, we also provide the resulting dataframe you will construct in the cell below. If you want to use the saved version, use the following code instead to obtain <code class="docutils literal notranslate"><span class="pre">bioactivities_df</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># replace first line in cell below with this other line</span>
<span class="n">bioactivities_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">DATA</span> <span class="o">/</span> <span class="s2">"EGFR_bioactivities_CHEMBL27.csv.zip"</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</details><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bioactivities_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">bioactivities</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">bioactivities_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (9576, 13)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>activity_id</th>
<th>assay_chembl_id</th>
<th>assay_description</th>
<th>assay_type</th>
<th>molecule_chembl_id</th>
<th>relation</th>
<th>standard_units</th>
<th>standard_value</th>
<th>target_chembl_id</th>
<th>target_organism</th>
<th>type</th>
<th>units</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>32260</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL68920</td>
<td>=</td>
<td>nM</td>
<td>41.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
<td>uM</td>
<td>0.041</td>
</tr>
<tr>
<th>1</th>
<td>32267</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL69960</td>
<td>=</td>
<td>nM</td>
<td>170.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
<td>uM</td>
<td>0.17</td>
</tr>
<tr>
<th>2</th>
<td>32680</td>
<td>CHEMBL677833</td>
<td>In vitro inhibition of Epidermal growth factor...</td>
<td>B</td>
<td>CHEMBL137635</td>
<td>=</td>
<td>nM</td>
<td>9300.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
<td>uM</td>
<td>9.3</td>
</tr>
<tr>
<th>3</th>
<td>32770</td>
<td>CHEMBL674643</td>
<td>Inhibitory concentration of EGF dependent auto...</td>
<td>B</td>
<td>CHEMBL306988</td>
<td>=</td>
<td>nM</td>
<td>500000.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
<td>uM</td>
<td>500.0</td>
</tr>
<tr>
<th>4</th>
<td>32772</td>
<td>CHEMBL674643</td>
<td>Inhibitory concentration of EGF dependent auto...</td>
<td>B</td>
<td>CHEMBL66879</td>
<td>=</td>
<td>nM</td>
<td>3000000.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
<td>uM</td>
<td>3000.0</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<p>Note that the first two rows describe the same bioactivity entry; we will remove such artifacts later during the deduplication step. Note also that we have columns for <code class="docutils literal notranslate"><span class="pre">standard_units</span></code>/<code class="docutils literal notranslate"><span class="pre">units</span></code> and <code class="docutils literal notranslate"><span class="pre">standard_values</span></code>/<code class="docutils literal notranslate"><span class="pre">values</span></code>; in the following, we will use the standardized columns (standardization by ChEMBL), and thus, we drop the other two columns.</p>
<p>If we used the <code class="docutils literal notranslate"><span class="pre">units</span></code> and <code class="docutils literal notranslate"><span class="pre">values</span></code> columns, we would need to convert all values with many different units to nM:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bioactivities_df</span><span class="p">[</span><span class="s2">"units"</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array(['uM', 'nM', 'pM', 'M', "10'3 uM", "10'1 ug/ml", 'ug ml-1',
       "10'-1microM", "10'1 uM", "10'-1 ug/ml", "10'-2 ug/ml", "10'2 uM",
       "10'-3 ug/ml", "10'-2microM", '/uM', "10'-6g/ml", 'mM', 'umol/L',
       'nmol/L', "10'-10M", "10'-7M", 'nmol', '10^-8M'], dtype=object)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">"units"</span><span class="p">,</span> <span class="s2">"value"</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">bioactivities_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>activity_id</th>
<th>assay_chembl_id</th>
<th>assay_description</th>
<th>assay_type</th>
<th>molecule_chembl_id</th>
<th>relation</th>
<th>standard_units</th>
<th>standard_value</th>
<th>target_chembl_id</th>
<th>target_organism</th>
<th>type</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>32260</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL68920</td>
<td>=</td>
<td>nM</td>
<td>41.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>1</th>
<td>32267</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL69960</td>
<td>=</td>
<td>nM</td>
<td>170.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>2</th>
<td>32680</td>
<td>CHEMBL677833</td>
<td>In vitro inhibition of Epidermal growth factor...</td>
<td>B</td>
<td>CHEMBL137635</td>
<td>=</td>
<td>nM</td>
<td>9300.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>3</th>
<td>32770</td>
<td>CHEMBL674643</td>
<td>Inhibitory concentration of EGF dependent auto...</td>
<td>B</td>
<td>CHEMBL306988</td>
<td>=</td>
<td>nM</td>
<td>500000.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>4</th>
<td>32772</td>
<td>CHEMBL674643</td>
<td>Inhibitory concentration of EGF dependent auto...</td>
<td>B</td>
<td>CHEMBL66879</td>
<td>=</td>
<td>nM</td>
<td>3000000.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</section>
<section id="Preprocess-and-filter-bioactivity-data">
<h4 id="Preprocess-and-filter-bioactivity-data">Preprocess and filter bioactivity data<a class="headerlink" href="#Preprocess-and-filter-bioactivity-data" title="Permalink to this heading">¶</a></h4>
<ol class="arabic simple">
<li><p>Convert <code class="docutils literal notranslate"><span class="pre">standard_value</span></code>’s datatype from <code class="docutils literal notranslate"><span class="pre">object</span></code> to <code class="docutils literal notranslate"><span class="pre">float</span></code></p></li>
<li><p>Delete entries with missing values</p></li>
<li><p>Keep only entries with <code class="docutils literal notranslate"><span class="pre">standard_unit</span> <span class="pre">==</span> <span class="pre">nM</span></code></p></li>
<li><p>Delete duplicate molecules</p></li>
<li><p>Reset <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> index</p></li>
<li><p>Rename columns</p></li>
</ol>
<p><strong>1. Convert datatype of “standard_value” from “object” to “float”</strong></p>
<p>The field <code class="docutils literal notranslate"><span class="pre">standard_value</span></code> holds standardized (here IC50) values. In order to make these values usable in calculations later on, convert values to floats.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
activity_id            int64
assay_chembl_id       object
assay_description     object
assay_type            object
molecule_chembl_id    object
relation              object
standard_units        object
standard_value        object
target_chembl_id      object
target_organism       object
type                  object
dtype: object
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bioactivities_df</span> <span class="o">=</span> <span class="n">bioactivities_df</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s2">"standard_value"</span><span class="p">:</span> <span class="s2">"float64"</span><span class="p">})</span>
<span class="n">bioactivities_df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
activity_id             int64
assay_chembl_id        object
assay_description      object
assay_type             object
molecule_chembl_id     object
relation               object
standard_units         object
standard_value        float64
target_chembl_id       object
target_organism        object
type                   object
dtype: object
</pre></div></div>
</div>
<p><strong>2. Delete entries with missing values</strong></p>
<p>Use the parameter <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code> to drop values in the current <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> directly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">"any"</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (9575, 11)
</pre></div></div>
</div>
<p><strong>3. Keep only entries with “standard_unit == nM”</strong></p>
<p>We only want to keep bioactivity entries in <code class="docutils literal notranslate"><span class="pre">nM</span></code>, thus we remove all entries with other units.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Units in downloaded data: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="p">[</span><span class="s1">'standard_units'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">"Number of non-nM entries:</span><span class="se">\</span>
<span class="s2">    </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="p">[</span><span class="n">bioactivities_df</span><span class="p">[</span><span class="s1">'standard_units'</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s1">'nM'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Units in downloaded data: ['nM' 'ug.mL-1' '/uM']
Number of non-nM entries:    69
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bioactivities_df</span> <span class="o">=</span> <span class="n">bioactivities_df</span><span class="p">[</span><span class="n">bioactivities_df</span><span class="p">[</span><span class="s2">"standard_units"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"nM"</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Units after filtering: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="p">[</span><span class="s1">'standard_units'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Units after filtering: ['nM']
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (9506, 11)
</pre></div></div>
</div>
<p><strong>4. Delete duplicate molecules</strong></p>
<p>Sometimes the same molecule (<code class="docutils literal notranslate"><span class="pre">molecule_chembl_id</span></code>) has been tested more than once, in this case, we only keep the first one.</p>
<p>Note other choices could be to keep the one with the best value or a mean value of all assay results for the respective compound.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s2">"molecule_chembl_id"</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s2">"first"</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (6461, 11)
</pre></div></div>
</div>
<p><strong>5. Reset “DataFrame” index</strong></p>
<p>Since we deleted some rows, but we want to iterate over the index later, we reset the index to be continuous.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">bioactivities_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>activity_id</th>
<th>assay_chembl_id</th>
<th>assay_description</th>
<th>assay_type</th>
<th>molecule_chembl_id</th>
<th>relation</th>
<th>standard_units</th>
<th>standard_value</th>
<th>target_chembl_id</th>
<th>target_organism</th>
<th>type</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>32260</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL68920</td>
<td>=</td>
<td>nM</td>
<td>41.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>1</th>
<td>32267</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL69960</td>
<td>=</td>
<td>nM</td>
<td>170.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>2</th>
<td>32680</td>
<td>CHEMBL677833</td>
<td>In vitro inhibition of Epidermal growth factor...</td>
<td>B</td>
<td>CHEMBL137635</td>
<td>=</td>
<td>nM</td>
<td>9300.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>3</th>
<td>32770</td>
<td>CHEMBL674643</td>
<td>Inhibitory concentration of EGF dependent auto...</td>
<td>B</td>
<td>CHEMBL306988</td>
<td>=</td>
<td>nM</td>
<td>500000.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>4</th>
<td>32772</td>
<td>CHEMBL674643</td>
<td>Inhibitory concentration of EGF dependent auto...</td>
<td>B</td>
<td>CHEMBL66879</td>
<td>=</td>
<td>nM</td>
<td>3000000.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<p><strong>6. Rename columns</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"standard_value"</span><span class="p">:</span> <span class="s2">"IC50"</span><span class="p">,</span> <span class="s2">"standard_units"</span><span class="p">:</span> <span class="s2">"units"</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">bioactivities_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>activity_id</th>
<th>assay_chembl_id</th>
<th>assay_description</th>
<th>assay_type</th>
<th>molecule_chembl_id</th>
<th>relation</th>
<th>units</th>
<th>IC50</th>
<th>target_chembl_id</th>
<th>target_organism</th>
<th>type</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>32260</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL68920</td>
<td>=</td>
<td>nM</td>
<td>41.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>1</th>
<td>32267</td>
<td>CHEMBL674637</td>
<td>Inhibitory activity towards tyrosine phosphory...</td>
<td>B</td>
<td>CHEMBL69960</td>
<td>=</td>
<td>nM</td>
<td>170.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>2</th>
<td>32680</td>
<td>CHEMBL677833</td>
<td>In vitro inhibition of Epidermal growth factor...</td>
<td>B</td>
<td>CHEMBL137635</td>
<td>=</td>
<td>nM</td>
<td>9300.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>3</th>
<td>32770</td>
<td>CHEMBL674643</td>
<td>Inhibitory concentration of EGF dependent auto...</td>
<td>B</td>
<td>CHEMBL306988</td>
<td>=</td>
<td>nM</td>
<td>500000.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
<tr>
<th>4</th>
<td>32772</td>
<td>CHEMBL674643</td>
<td>Inhibitory concentration of EGF dependent auto...</td>
<td>B</td>
<td>CHEMBL66879</td>
<td>=</td>
<td>nM</td>
<td>3000000.0</td>
<td>CHEMBL203</td>
<td>Homo sapiens</td>
<td>IC50</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (6461, 11)
</pre></div></div>
</div>
<p>We now have a set of <strong>5575</strong> molecule ids with respective IC50 values for our target kinase.</p>
</section>
</section>
<section id="Get-compound-data">
<h3 id="Get-compound-data">Get compound data<a class="headerlink" href="#Get-compound-data" title="Permalink to this heading">¶</a></h3>
<p>We have a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> containing all molecules tested against EGFR (with the respective measured bioactivity).</p>
<p>Now, we want to get the molecular structures of the molecules that are linked to respective bioactivity ChEMBL IDs.</p>
<section id="Fetch-compound-data-from-ChEMBL">
<h4 id="Fetch-compound-data-from-ChEMBL">Fetch compound data from ChEMBL<a class="headerlink" href="#Fetch-compound-data-from-ChEMBL" title="Permalink to this heading">¶</a></h4>
<p>Let’s have a look at the compounds from ChEMBL which we have defined bioactivity data for: We fetch compound ChEMBL IDs and structures for the compounds linked to our filtered bioactivity data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compounds_provider</span> <span class="o">=</span> <span class="n">compounds_api</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">molecule_chembl_id__in</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">bioactivities_df</span><span class="p">[</span><span class="s2">"molecule_chembl_id"</span><span class="p">])</span>
<span class="p">)</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s2">"molecule_chembl_id"</span><span class="p">,</span> <span class="s2">"molecule_structures"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Download-compound-data-from-ChEMBL">
<h4 id="Download-compound-data-from-ChEMBL">Download compound data from ChEMBL<a class="headerlink" href="#Download-compound-data-from-ChEMBL" title="Permalink to this heading">¶</a></h4>
<p>Again, we want to export the <code class="docutils literal notranslate"><span class="pre">QuerySet</span></code> object into a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>. Given the data volume, <strong>this can take some time.</strong> For that reason, we will first obtain the list of records through <code class="docutils literal notranslate"><span class="pre">tqdm</span></code>, so we get a nice progress bar and some ETAs. We can then pass the list of compounds to the DataFrame.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compounds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">compounds_provider</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "00f2933de0e84fed92bd432cc4015eab", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compounds_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span>
    <span class="n">compounds</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">compounds_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (6461, 2)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compounds_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>molecule_chembl_id</th>
<th>molecule_structures</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL6246</td>
<td>{'canonical_smiles': 'O=c1oc2c(O)c(O)cc3c(=O)o...</td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL10</td>
<td>{'canonical_smiles': 'C[S+]([O-])c1ccc(-c2nc(-...</td>
</tr>
<tr>
<th>2</th>
<td>CHEMBL6976</td>
<td>{'canonical_smiles': 'COc1cc2c(cc1OC)Nc1ncn(C)...</td>
</tr>
<tr>
<th>3</th>
<td>CHEMBL7002</td>
<td>{'canonical_smiles': 'CC1(COc2ccc(CC3SC(=O)NC3...</td>
</tr>
<tr>
<th>4</th>
<td>CHEMBL414013</td>
<td>{'canonical_smiles': 'COc1cc2c(cc1OC)Nc1ncnc(O...</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</section>
<section id="Preprocess-and-filter-compound-data">
<h4 id="Preprocess-and-filter-compound-data">Preprocess and filter compound data<a class="headerlink" href="#Preprocess-and-filter-compound-data" title="Permalink to this heading">¶</a></h4>
<ol class="arabic simple">
<li><p>Remove entries with missing entries</p></li>
<li><p>Delete duplicate molecules (by molecule_chembl_id)</p></li>
<li><p>Get molecules with canonical SMILES</p></li>
</ol>
<p><strong>1. Remove entries with missing molecule structure entry</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compounds_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">"any"</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">compounds_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (6454, 2)
</pre></div></div>
</div>
<p><strong>2. Delete duplicate molecules</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compounds_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s2">"molecule_chembl_id"</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s2">"first"</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">compounds_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (6454, 2)
</pre></div></div>
</div>
<p><strong>3. Get molecules with canonical SMILES</strong></p>
<p>So far, we have multiple different molecular structure representations. We only want to keep the canonical SMILES.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compounds_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">molecule_structures</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys(['canonical_smiles', 'molfile', 'standard_inchi', 'standard_inchi_key'])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">canonical_smiles</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">compounds</span> <span class="ow">in</span> <span class="n">compounds_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">canonical_smiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compounds</span><span class="p">[</span><span class="s2">"molecule_structures"</span><span class="p">][</span><span class="s2">"canonical_smiles"</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">canonical_smiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">compounds_df</span><span class="p">[</span><span class="s2">"smiles"</span><span class="p">]</span> <span class="o">=</span> <span class="n">canonical_smiles</span>
<span class="n">compounds_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">"molecule_structures"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">compounds_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (6454, 2)
</pre></div></div>
</div>
<p>Sanity check: Remove all molecules without a canonical SMILES string.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compounds_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">"any"</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">compounds_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (6454, 2)
</pre></div></div>
</div>
</section>
</section>
<section id="Output-(bioactivity-compound)-data">
<h3 id="Output-(bioactivity-compound)-data">Output (bioactivity-compound) data<a class="headerlink" href="#Output-(bioactivity-compound)-data" title="Permalink to this heading">¶</a></h3>
<p><strong>Summary of compound and bioactivity data</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Bioactivities filtered: </span><span class="si">{</span><span class="n">bioactivities_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">bioactivities_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Bioactivities filtered: 6461
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index(['activity_id', 'assay_chembl_id', 'assay_description', 'assay_type',
       'molecule_chembl_id', 'relation', 'units', 'IC50', 'target_chembl_id',
       'target_organism', 'type'],
      dtype='object')
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Compounds filtered: </span><span class="si">{</span><span class="n">compounds_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">compounds_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Compounds filtered: 6454
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Index(['molecule_chembl_id', 'smiles'], dtype='object')
</pre></div></div>
</div>
<section id="Merge-both-datasets">
<h4 id="Merge-both-datasets">Merge both datasets<a class="headerlink" href="#Merge-both-datasets" title="Permalink to this heading">¶</a></h4>
<p>Merge values of interest from <code class="docutils literal notranslate"><span class="pre">bioactivities_df</span></code> and <code class="docutils literal notranslate"><span class="pre">compounds_df</span></code> in an <code class="docutils literal notranslate"><span class="pre">output_df</span></code> based on the compounds’ ChEMBL IDs (<code class="docutils literal notranslate"><span class="pre">molecule_chembl_id</span></code>), keeping the following columns:</p>
<ul class="simple">
<li><p>ChEMBL IDs: <code class="docutils literal notranslate"><span class="pre">molecule_chembl_id</span></code></p></li>
<li><p>SMILES: <code class="docutils literal notranslate"><span class="pre">smiles</span></code></p></li>
<li><p>units: <code class="docutils literal notranslate"><span class="pre">units</span></code></p></li>
<li><p>IC50: <code class="docutils literal notranslate"><span class="pre">IC50</span></code></p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge DataFrames</span>
<span class="n">output_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">bioactivities_df</span><span class="p">[[</span><span class="s2">"molecule_chembl_id"</span><span class="p">,</span> <span class="s2">"IC50"</span><span class="p">,</span> <span class="s2">"units"</span><span class="p">]],</span>
    <span class="n">compounds_df</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">"molecule_chembl_id"</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Reset row indices</span>
<span class="n">output_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Dataset with </span><span class="si">{</span><span class="n">output_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> entries."</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dataset with 6454 entries.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
molecule_chembl_id     object
IC50                  float64
units                  object
smiles                 object
dtype: object
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>molecule_chembl_id</th>
<th>IC50</th>
<th>units</th>
<th>smiles</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL68920</td>
<td>41.0</td>
<td>nM</td>
<td>Cc1cc(C)c(/C=C2\C(=O)Nc3ncnc(Nc4ccc(F)c(Cl)c4)...</td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL69960</td>
<td>170.0</td>
<td>nM</td>
<td>Cc1cc(C(=O)N2CCOCC2)[nH]c1/C=C1\C(=O)Nc2ncnc(N...</td>
</tr>
<tr>
<th>2</th>
<td>CHEMBL137635</td>
<td>9300.0</td>
<td>nM</td>
<td>CN(c1ccccc1)c1ncnc2ccc(N/N=N/Cc3ccccn3)cc12</td>
</tr>
<tr>
<th>3</th>
<td>CHEMBL306988</td>
<td>500000.0</td>
<td>nM</td>
<td>CC(=C(C#N)C#N)c1ccc(NC(=O)CCC(=O)O)cc1</td>
</tr>
<tr>
<th>4</th>
<td>CHEMBL66879</td>
<td>3000000.0</td>
<td>nM</td>
<td>O=C(O)/C=C/c1ccc(O)cc1</td>
</tr>
<tr>
<th>5</th>
<td>CHEMBL77085</td>
<td>96000.0</td>
<td>nM</td>
<td>N#CC(C#N)=Cc1cc(O)ccc1[N+](=O)[O-]</td>
</tr>
<tr>
<th>6</th>
<td>CHEMBL443268</td>
<td>5310.0</td>
<td>nM</td>
<td>Cc1cc(C(=O)NCCN2CCOCC2)[nH]c1/C=C1\C(=O)N(C)c2...</td>
</tr>
<tr>
<th>7</th>
<td>CHEMBL76979</td>
<td>264000.0</td>
<td>nM</td>
<td>COc1cc(/C=C(\C#N)C(=O)O)cc(OC)c1O</td>
</tr>
<tr>
<th>8</th>
<td>CHEMBL76589</td>
<td>125.0</td>
<td>nM</td>
<td>N#CC(C#N)=C(N)/C(C#N)=C/c1ccc(O)cc1</td>
</tr>
<tr>
<th>9</th>
<td>CHEMBL76904</td>
<td>35000.0</td>
<td>nM</td>
<td>N#CC(C#N)=Cc1ccc(O)c(O)c1</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</section>
<section id="Add-pIC50-values">
<h4 id="Add-pIC50-values">Add pIC50 values<a class="headerlink" href="#Add-pIC50-values" title="Permalink to this heading">¶</a></h4>
<p>As you can see the low IC50 values are difficult to read (values are distributed over multiple scales), which is why we convert the IC50 values to pIC50.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">convert_ic50_to_pic50</span><span class="p">(</span><span class="n">IC50_value</span><span class="p">):</span>
    <span class="n">pIC50_value</span> <span class="o">=</span> <span class="mi">9</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">IC50_value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pIC50_value</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply conversion to each row of the compounds DataFrame</span>
<span class="n">output_df</span><span class="p">[</span><span class="s2">"pIC50"</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">convert_ic50_to_pic50</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">IC50</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>molecule_chembl_id</th>
<th>IC50</th>
<th>units</th>
<th>smiles</th>
<th>pIC50</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL68920</td>
<td>41.0</td>
<td>nM</td>
<td>Cc1cc(C)c(/C=C2\C(=O)Nc3ncnc(Nc4ccc(F)c(Cl)c4)...</td>
<td>7.387216</td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL69960</td>
<td>170.0</td>
<td>nM</td>
<td>Cc1cc(C(=O)N2CCOCC2)[nH]c1/C=C1\C(=O)Nc2ncnc(N...</td>
<td>6.769551</td>
</tr>
<tr>
<th>2</th>
<td>CHEMBL137635</td>
<td>9300.0</td>
<td>nM</td>
<td>CN(c1ccccc1)c1ncnc2ccc(N/N=N/Cc3ccccn3)cc12</td>
<td>5.031517</td>
</tr>
<tr>
<th>3</th>
<td>CHEMBL306988</td>
<td>500000.0</td>
<td>nM</td>
<td>CC(=C(C#N)C#N)c1ccc(NC(=O)CCC(=O)O)cc1</td>
<td>3.301030</td>
</tr>
<tr>
<th>4</th>
<td>CHEMBL66879</td>
<td>3000000.0</td>
<td>nM</td>
<td>O=C(O)/C=C/c1ccc(O)cc1</td>
<td>2.522879</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</section>
<section id="Draw-compound-data">
<h4 id="Draw-compound-data">Draw compound data<a class="headerlink" href="#Draw-compound-data" title="Permalink to this heading">¶</a></h4>
<p>Let’s have a look at our collected data set.</p>
<p>First, we plot the pIC50 value distribution</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_df</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">"pIC50"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[&lt;Axes: title={'center': 'pIC50'}&gt;]], dtype=object)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/talktorials_T001_query_chembl_91_1.png" src="../_images/talktorials_T001_query_chembl_91_1.png"/>
</div>
</div>
<p>In the next steps, we add a column for RDKit molecule objects to our <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> and look at the structures of the molecules with the highest pIC50 values.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add molecule column</span>
<span class="n">PandasTools</span><span class="o">.</span><span class="n">AddMoleculeColumnToFrame</span><span class="p">(</span><span class="n">output_df</span><span class="p">,</span> <span class="n">smilesCol</span><span class="o">=</span><span class="s2">"smiles"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sort molecules by pIC50</span>
<span class="n">output_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">"pIC50"</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Reset index</span>
<span class="n">output_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Show the three most active molecules, i.e. molecules with the highest pIC50 values.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">"smiles"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>molecule_chembl_id</th>
<th>IC50</th>
<th>units</th>
<th>pIC50</th>
<th>ROMol</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL63786</td>
<td>0.003</td>
<td>nM</td>
<td>11.522879</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f041e269430&gt;</td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL53711</td>
<td>0.006</td>
<td>nM</td>
<td>11.221849</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f041e260ac0&gt;</td>
</tr>
<tr>
<th>2</th>
<td>CHEMBL35820</td>
<td>0.006</td>
<td>nM</td>
<td>11.221849</td>
<td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f041e253ac0&gt;</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prepare saving the dataset: Drop the ROMol column</span>
<span class="n">output_df</span> <span class="o">=</span> <span class="n">output_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">"ROMol"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">output_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (6454, 5)
</pre></div></div>
</div>
</section>
<section id="Freeze-output-data-to-ChEMBL-27">
<h4 id="Freeze-output-data-to-ChEMBL-27">Freeze output data to ChEMBL 27<a class="headerlink" href="#Freeze-output-data-to-ChEMBL-27" title="Permalink to this heading">¶</a></h4>
<p>This is a technical step: Usually, we would continue to work with the dataset that we just created (latest dataset).</p>
<p>However, here on the TeachOpenCADD platform, we prefer to freeze the dataset to a certain ChEMBL releases (i.e. <a class="reference external" href="http://doi.org/10.6019/CHEMBL.database.27">ChEMBL 27</a>), so that this talktorial and other talktorials downstream in our CADD pipeline do not change in the future (helping us to maintain the talktorials).</p>
<div class="alert alert-block alert-info"><p>Note: If you prefer to run this notebook on the latest dataset or if you want to use it for another target, please comment the cell below.</p>
</div><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Disable this cell to unfreeze the dataset</span>
<span class="n">output_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="n">DATA</span> <span class="o">/</span> <span class="s2">"EGFR_compounds_ea055ef.csv"</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">float_precision</span><span class="o">=</span><span class="s2">"round_trip"</span>
<span class="p">)</span>
<span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>molecule_chembl_id</th>
<th>IC50</th>
<th>units</th>
<th>smiles</th>
<th>pIC50</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL63786</td>
<td>0.003</td>
<td>nM</td>
<td>Brc1cccc(Nc2ncnc3cc4ccccc4cc23)c1</td>
<td>11.522879</td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL35820</td>
<td>0.006</td>
<td>nM</td>
<td>CCOc1cc2ncnc(Nc3cccc(Br)c3)c2cc1OCC</td>
<td>11.221849</td>
</tr>
<tr>
<th>2</th>
<td>CHEMBL53711</td>
<td>0.006</td>
<td>nM</td>
<td>CN(C)c1cc2c(Nc3cccc(Br)c3)ncnc2cn1</td>
<td>11.221849</td>
</tr>
<tr>
<th>3</th>
<td>CHEMBL66031</td>
<td>0.008</td>
<td>nM</td>
<td>Brc1cccc(Nc2ncnc3cc4[nH]cnc4cc23)c1</td>
<td>11.096910</td>
</tr>
<tr>
<th>4</th>
<td>CHEMBL53753</td>
<td>0.008</td>
<td>nM</td>
<td>CNc1cc2c(Nc3cccc(Br)c3)ncnc2cn1</td>
<td>11.096910</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">output_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (5568, 5)
</pre></div></div>
</div>
</section>
<section id="Write-output-data-to-file">
<h4 id="Write-output-data-to-file">Write output data to file<a class="headerlink" href="#Write-output-data-to-file" title="Permalink to this heading">¶</a></h4>
<p>We want to use this bioactivity-compound dataset in the following talktorials, thus we save the data as <code class="docutils literal notranslate"><span class="pre">csv</span></code> file. Note that it is advisable to drop the molecule column (which only contains an image of the molecules) when saving the data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">DATA</span> <span class="o">/</span> <span class="s2">"EGFR_compounds.csv"</span><span class="p">)</span>
<span class="n">output_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>molecule_chembl_id</th>
<th>IC50</th>
<th>units</th>
<th>smiles</th>
<th>pIC50</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>CHEMBL63786</td>
<td>0.003</td>
<td>nM</td>
<td>Brc1cccc(Nc2ncnc3cc4ccccc4cc23)c1</td>
<td>11.522879</td>
</tr>
<tr>
<th>1</th>
<td>CHEMBL35820</td>
<td>0.006</td>
<td>nM</td>
<td>CCOc1cc2ncnc(Nc3cccc(Br)c3)c2cc1OCC</td>
<td>11.221849</td>
</tr>
<tr>
<th>2</th>
<td>CHEMBL53711</td>
<td>0.006</td>
<td>nM</td>
<td>CN(C)c1cc2c(Nc3cccc(Br)c3)ncnc2cn1</td>
<td>11.221849</td>
</tr>
<tr>
<th>3</th>
<td>CHEMBL66031</td>
<td>0.008</td>
<td>nM</td>
<td>Brc1cccc(Nc2ncnc3cc4[nH]cnc4cc23)c1</td>
<td>11.096910</td>
</tr>
<tr>
<th>4</th>
<td>CHEMBL53753</td>
<td>0.008</td>
<td>nM</td>
<td>CNc1cc2c(Nc3cccc(Br)c3)ncnc2cn1</td>
<td>11.096910</td>
</tr>
</tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"DataFrame shape: </span><span class="si">{</span><span class="n">output_df</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="c1"># NBVAL_CHECK_OUTPUT</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame shape: (5568, 5)
</pre></div></div>
</div>
</section>
</section>
</section>
<section id="Discussion">
<h2 id="Discussion">Discussion<a class="headerlink" href="#Discussion" title="Permalink to this heading">¶</a></h2>
<p>In this tutorial, we collected bioactivity data for our target of interest from the ChEMBL database. We filtered the data set in order to only contain molecules with measured IC50 bioactivity values.</p>
<p>Be aware that ChEMBL data originates from various sources. Compound data has been generated in different labs by different people all over the world. Therefore, we have to be cautious with the predictions we make using this data set. It is always important to consider the source of the data and consistency of data production assays when interpreting the results and determining how much confidence we have in our predictions.</p>
<p>In the next tutorials, we will filter our acquired data by Lipinski’s rule of five and by unwanted substructures. Another important step would be to <em>clean</em> the molecular data. As this is not shown in any of our talktorials (yet), we would like to refer to the <a class="reference external" href="https://github.com/flatkinson/standardiser">Standardiser library</a> or <a class="reference external" href="https://molvs.readthedocs.io/en/latest/">MolVS</a> as useful tools for this task.</p>
</section>
<section id="Quiz">
<h2 id="Quiz">Quiz<a class="headerlink" href="#Quiz" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>We have downloaded in this talktorial molecules and bioactivity data from ChEMBL. What else is the ChEMBL database useful for?</p></li>
<li><p>What is the difference between IC50 and EC50?</p></li>
<li><p>What can we use the data extracted from ChEMBL for?</p></li>
</ul>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {}, "version_major": 2, "version_minor": 0}
</script></section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="../all_talktorials.html" title="Complete list of talktorials"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Complete list of talktorials </span>
              </div>
            </a>
          
          
            <a href="T002_compound_adme.html" title="T002 · Molecular filtering: ADME and lead-likeness criteria"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> T002 · Molecular filtering: ADME and lead-likeness criteria </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2018-2023, Volkamer Lab. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.1.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>